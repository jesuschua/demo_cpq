{"ast":null,"code":"var _jsxFileName = \"/Users/dkjesuschua/Documents/demo_cpq/src/ImprovedApp.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { customers, models, products, processings, processingRules, productDependencies } from './data/sampleData';\nimport MinimalDashboard from './components/MinimalDashboard';\nimport CustomerSelector from './components/CustomerSelector';\nimport EnhancedRoomManager from './components/EnhancedRoomManager';\nimport CleanProductCatalog from './components/CleanProductCatalog';\nimport LiveProcessingProductManager from './components/LiveProcessingProductManager';\n\n// Define the 4 clear phases\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction ImprovedApp() {\n  _s();\n  var _workflow$customer, _getCurrentRoom, _getCurrentRoom2, _getCurrentRoom3, _getCurrentRoomModel, _getCurrentRoom4;\n  const [currentView, setCurrentView] = useState('dashboard');\n  const [workflow, setWorkflow] = useState({\n    currentPhase: 'customer_config',\n    customer: null,\n    rooms: [],\n    currentRoomId: null,\n    products: [],\n    quote: null,\n    savedStates: {}\n  });\n\n  // Phase progression with validation\n  const canProceedToNextPhase = () => {\n    switch (workflow.currentPhase) {\n      case 'customer_config':\n        return workflow.customer !== null;\n      case 'room_config':\n        return workflow.rooms.length > 0;\n      case 'product_config':\n        {\n          // Ensure there's at least one product total (can be lenient about all rooms having products)\n          return workflow.products.length > 0;\n        }\n      case 'quote_finalize':\n        return workflow.quote !== null;\n      default:\n        return false;\n    }\n  };\n  const proceedToNextPhase = () => {\n    const phaseOrder = ['customer_config', 'room_config', 'product_config', 'quote_finalize'];\n    const currentIndex = phaseOrder.indexOf(workflow.currentPhase);\n    if (currentIndex < phaseOrder.length - 1 && canProceedToNextPhase()) {\n      const nextPhase = phaseOrder[currentIndex + 1];\n\n      // Auto-create quote when moving to product config\n      if (nextPhase === 'product_config' && !workflow.quote) {\n        createQuoteFromCurrentState();\n      }\n\n      // Update quote when moving to quote finalization\n      if (nextPhase === 'quote_finalize') {\n        createQuoteFromCurrentState();\n      }\n      setWorkflow(prev => ({\n        ...prev,\n        currentPhase: nextPhase,\n        savedStates: {\n          ...prev.savedStates,\n          [prev.currentPhase]: getCurrentPhaseData()\n        }\n      }));\n    }\n  };\n  const goToPreviousPhase = () => {\n    const phaseOrder = ['customer_config', 'room_config', 'product_config', 'quote_finalize'];\n    const currentIndex = phaseOrder.indexOf(workflow.currentPhase);\n    if (currentIndex > 0) {\n      const prevPhase = phaseOrder[currentIndex - 1];\n      setWorkflow(prev => ({\n        ...prev,\n        currentPhase: prevPhase\n      }));\n    }\n  };\n  const getCurrentPhaseData = () => {\n    switch (workflow.currentPhase) {\n      case 'customer_config':\n        return workflow.customer;\n      case 'room_config':\n        return workflow.rooms;\n      case 'product_config':\n        return workflow.products;\n      case 'quote_finalize':\n        return workflow.quote;\n      default:\n        return null;\n    }\n  };\n\n  // Save current phase state\n  const saveCurrentPhase = () => {\n    const currentData = getCurrentPhaseData();\n    setWorkflow(prev => ({\n      ...prev,\n      savedStates: {\n        ...prev.savedStates,\n        [prev.currentPhase]: currentData\n      }\n    }));\n\n    // Show save confirmation\n    const phaseNames = {\n      customer_config: 'Customer Configuration',\n      room_config: 'Room Configuration',\n      product_config: 'Product Configuration',\n      quote_finalize: 'Quote'\n    };\n    alert(`${phaseNames[workflow.currentPhase]} saved successfully!`);\n  };\n\n  // Create quote from current state\n  const createQuoteFromCurrentState = () => {\n    if (!workflow.customer || workflow.rooms.length === 0) return;\n    const newQuote = {\n      id: Date.now().toString(),\n      customerId: workflow.customer.id,\n      rooms: workflow.rooms,\n      items: workflow.products,\n      contractDiscount: 0,\n      customerDiscount: workflow.customer.discountPercentage || 0,\n      orderDiscount: 0,\n      subtotal: 0,\n      totalDiscount: 0,\n      finalTotal: 0,\n      status: 'draft',\n      createdAt: new Date(),\n      expiresAt: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000),\n      requiresApproval: false,\n      approvalThreshold: 5000\n    };\n    const updatedQuote = recalculateQuote(newQuote);\n    setWorkflow(prev => ({\n      ...prev,\n      quote: updatedQuote\n    }));\n  };\n\n  // Recalculate quote totals\n  const recalculateQuote = quote => {\n    const subtotal = quote.items.reduce((sum, item) => sum + item.totalPrice, 0);\n    const customerDiscount = subtotal * (quote.customerDiscount / 100);\n    const totalDiscount = customerDiscount + quote.orderDiscount;\n    const finalTotal = subtotal - totalDiscount;\n    return {\n      ...quote,\n      subtotal,\n      totalDiscount,\n      finalTotal,\n      requiresApproval: finalTotal > quote.approvalThreshold\n    };\n  };\n\n  // Cascading updates when stepping back\n  useEffect(() => {\n    // If customer changes, clear rooms and products\n    if (workflow.currentPhase === 'customer_config' && workflow.rooms.length > 0) {\n      setWorkflow(prev => ({\n        ...prev,\n        rooms: [],\n        currentRoomId: null,\n        products: [],\n        quote: null\n      }));\n    }\n\n    // If rooms change, clear products that don't match any room's model\n    if (workflow.currentPhase === 'room_config' && workflow.rooms.length > 0 && workflow.products.length > 0) {\n      const roomModelIds = workflow.rooms.map(room => {\n        const roomModel = models.find(m => m.id === room.frontModelId);\n        return roomModel === null || roomModel === void 0 ? void 0 : roomModel.id;\n      }).filter(Boolean);\n      if (roomModelIds.length > 0) {\n        const compatibleProducts = workflow.products.filter(item => {\n          const product = products.find(p => p.id === item.productId);\n          return product && roomModelIds.includes(product.modelId);\n        });\n        if (compatibleProducts.length !== workflow.products.length) {\n          setWorkflow(prev => ({\n            ...prev,\n            products: compatibleProducts,\n            quote: null // Clear quote to force recalculation\n          }));\n        }\n      }\n    }\n\n    // Auto-select first room when entering product config phase\n    if (workflow.currentPhase === 'product_config' && workflow.rooms.length > 0 && !workflow.currentRoomId) {\n      setWorkflow(prev => ({\n        ...prev,\n        currentRoomId: prev.rooms[0].id\n      }));\n    }\n  }, [workflow.customer, workflow.rooms, workflow.currentPhase, workflow.products, workflow.currentRoomId]);\n\n  // Phase-specific handlers\n  const handleCustomerSelect = customer => {\n    setWorkflow(prev => ({\n      ...prev,\n      customer\n    }));\n  };\n  const handleRoomCreate = room => {\n    setWorkflow(prev => ({\n      ...prev,\n      rooms: [...prev.rooms, room],\n      currentRoomId: room.id\n    }));\n  };\n  const handleRoomEdit = editedRoom => {\n    setWorkflow(prev => ({\n      ...prev,\n      rooms: prev.rooms.map(room => room.id === editedRoom.id ? editedRoom : room)\n    }));\n  };\n  const handleRoomSelect = roomId => {\n    setWorkflow(prev => ({\n      ...prev,\n      currentRoomId: roomId\n    }));\n  };\n\n  // Helper function to get the current room\n  const getCurrentRoom = () => {\n    if (workflow.currentRoomId) {\n      return workflow.rooms.find(room => room.id === workflow.currentRoomId) || null;\n    }\n    // If no specific room is selected, return the last added room\n    return workflow.rooms.length > 0 ? workflow.rooms[workflow.rooms.length - 1] : null;\n  };\n  const handleProductAdd = (productId, quantity = 1) => {\n    const currentRoom = getCurrentRoom();\n    if (!currentRoom) return;\n    const product = products.find(p => p.id === productId);\n    if (!product) return;\n\n    // Apply room-level inherited processings\n    const inheritedProcessings = currentRoom.activatedProcessings.map(processingId => {\n      const processing = processings.find(p => p.id === processingId);\n      if (!processing) return null;\n\n      // Check if this processing is applicable to this product category\n      if (!processing.applicableProductCategories.includes(product.category)) {\n        return null;\n      }\n      let calculatedPrice = 0;\n      if (processing.pricingType === 'per_unit') {\n        calculatedPrice = processing.price * quantity;\n      } else if (processing.pricingType === 'percentage') {\n        calculatedPrice = product.basePrice * quantity * (processing.price / 100);\n      } else if (processing.pricingType === 'per_dimension' && product.dimensions) {\n        // Basic dimension calculation - can be enhanced with formula evaluation\n        const dimensionSum = (product.dimensions.width || 0) + (product.dimensions.height || 0) + (product.dimensions.depth || 0);\n        calculatedPrice = dimensionSum * processing.price * quantity;\n      }\n      return {\n        processingId: processing.id,\n        calculatedPrice,\n        isInherited: true,\n        appliedDate: new Date().toISOString()\n      };\n    }).filter(Boolean);\n    const newItem = {\n      id: Date.now().toString(),\n      productId,\n      roomId: currentRoom.id,\n      quantity,\n      appliedProcessings: inheritedProcessings,\n      basePrice: product.basePrice,\n      totalPrice: product.basePrice * quantity + inheritedProcessings.reduce((sum, p) => sum + ((p === null || p === void 0 ? void 0 : p.calculatedPrice) || 0), 0)\n    };\n    setWorkflow(prev => ({\n      ...prev,\n      products: [...prev.products, newItem]\n    }));\n  };\n  const handleQuoteUpdate = updatedQuote => {\n    setWorkflow(prev => ({\n      ...prev,\n      quote: updatedQuote\n    }));\n  };\n\n  // Remove product from workflow\n  const removeProduct = productId => {\n    setWorkflow(prev => ({\n      ...prev,\n      products: prev.products.filter(item => item.productId !== productId)\n    }));\n  };\n  const adjustProductQuantity = (productId, change) => {\n    setWorkflow(prev => ({\n      ...prev,\n      products: prev.products.map(item => {\n        if (item.productId === productId) {\n          const newQuantity = item.quantity + change;\n          return {\n            ...item,\n            quantity: newQuantity\n          };\n        }\n        return item;\n      }).filter(item => item.quantity > 0) // Remove items with 0 or negative quantity\n    }));\n  };\n\n  // Print quote - Enhanced professional print functionality\n  const printQuote = () => {\n    if (!workflow.quote || !workflow.customer) {\n      alert('No quote available to print.');\n      return;\n    }\n    try {\n      // Create a new window for printing\n      const printWindow = window.open('', '_blank');\n      if (printWindow) {\n        printWindow.document.write(generateEnhancedPrintHTML());\n        printWindow.document.close();\n        printWindow.print();\n        printWindow.close();\n      }\n    } catch (error) {\n      console.error('Print failed:', error);\n      alert('Print functionality is not available in this browser.');\n    }\n  };\n\n  // Generate enhanced HTML for professional quote printing\n  const generateEnhancedPrintHTML = () => {\n    const quote = workflow.quote;\n    const customer = workflow.customer;\n    const getProduct = productId => products.find(p => p.id === productId);\n    const getModel = modelId => models.find(m => m.id === modelId);\n    const getProcessing = processingId => processings.find(p => p.id === processingId);\n\n    // Group items by room\n    const itemsByRoom = quote.items.reduce((acc, item) => {\n      const roomId = item.roomId;\n      if (!acc[roomId]) {\n        acc[roomId] = [];\n      }\n      acc[roomId].push(item);\n      return acc;\n    }, {});\n    return `\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <title>Professional Quote - ${quote.quoteNumber || quote.id}</title>\n          <meta charset=\"UTF-8\">\n          <style>\n            * { margin: 0; padding: 0; box-sizing: border-box; }\n            body { \n              font-family: 'Arial', sans-serif; \n              line-height: 1.6; \n              color: #333; \n              background: white;\n              font-size: 12px;\n            }\n            .container { max-width: 800px; margin: 0 auto; padding: 20px; }\n            \n            /* Header Styles */\n            .header { \n              border-bottom: 3px solid #2563eb; \n              padding-bottom: 20px; \n              margin-bottom: 30px; \n              display: flex;\n              justify-content: space-between;\n              align-items: flex-start;\n            }\n            .company-info h1 { \n              font-size: 28px; \n              font-weight: bold; \n              color: #2563eb; \n              margin-bottom: 5px;\n            }\n            .company-info p { color: #666; font-size: 14px; }\n            .quote-info { text-align: right; }\n            .quote-info h2 { \n              font-size: 24px; \n              color: #1f2937; \n              margin-bottom: 10px;\n            }\n            .quote-info p { margin-bottom: 5px; }\n            \n            /* Customer Section */\n            .customer-section { \n              background-color: #f8fafc; \n              padding: 20px; \n              border-radius: 8px; \n              margin-bottom: 30px; \n            }\n            .customer-section h3 { \n              font-size: 18px; \n              color: #374151; \n              margin-bottom: 15px;\n              border-bottom: 1px solid #d1d5db;\n              padding-bottom: 5px;\n            }\n            .customer-details { \n              display: grid; \n              grid-template-columns: 1fr 1fr; \n              gap: 15px; \n            }\n            \n            /* Room Sections */\n            .room-section { \n              margin-bottom: 40px; \n              border: 1px solid #e5e7eb;\n              border-radius: 8px;\n              overflow: hidden;\n            }\n            .room-header { \n              background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%); \n              color: white; \n              padding: 15px 20px; \n            }\n            .room-header h3 { font-size: 20px; margin-bottom: 5px; }\n            .room-header p { opacity: 0.9; }\n            .room-auto-processings { \n              background-color: #eff6ff; \n              padding: 15px 20px; \n              border-bottom: 1px solid #e5e7eb;\n            }\n            .room-auto-processings h4 { \n              color: #1e40af; \n              margin-bottom: 10px;\n              font-size: 14px;\n            }\n            .auto-processing-list { \n              display: flex; \n              flex-wrap: wrap; \n              gap: 8px; \n            }\n            .auto-processing-tag { \n              background-color: #dbeafe; \n              color: #1e40af; \n              padding: 4px 8px; \n              border-radius: 4px; \n              font-size: 11px;\n              font-weight: 500;\n            }\n            \n            /* Product Tables */\n            .products-table { \n              width: 100%; \n              border-collapse: collapse; \n            }\n            .products-table th { \n              background-color: #f9fafb; \n              padding: 12px; \n              text-align: left; \n              font-weight: 600;\n              border-bottom: 2px solid #e5e7eb;\n              font-size: 11px;\n              text-transform: uppercase;\n              letter-spacing: 0.5px;\n            }\n            .products-table td { \n              padding: 12px; \n              border-bottom: 1px solid #f3f4f6; \n              vertical-align: top;\n            }\n            .product-row:hover { background-color: #fafafa; }\n            .product-name { font-weight: 600; color: #1f2937; }\n            .product-category { \n              color: #6b7280; \n              font-size: 10px; \n              text-transform: uppercase;\n            }\n            \n            /* Processing Details */\n            .processing-details { \n              margin-top: 8px; \n            }\n            .processing-item { \n              display: flex; \n              justify-content: space-between; \n              align-items: center;\n              padding: 4px 0;\n              font-size: 11px;\n            }\n            .processing-inherited { \n              color: #059669; \n              font-weight: 500;\n            }\n            .processing-inherited::before { \n              content: \"üè† \"; \n            }\n            .processing-manual { \n              color: #7c3aed; \n              font-weight: 500;\n            }\n            .processing-manual::before { \n              content: \"‚öôÔ∏è \"; \n            }\n            \n            /* Summary Section */\n            .summary-section { \n              margin-top: 40px; \n              background-color: #f8fafc; \n              padding: 25px; \n              border-radius: 8px;\n            }\n            .summary-table { \n              width: 100%; \n              border-collapse: collapse; \n            }\n            .summary-table td { \n              padding: 8px 0; \n              border-bottom: 1px solid #e5e7eb;\n            }\n            .summary-table .label { font-weight: 600; }\n            .summary-table .value { \n              text-align: right; \n              font-weight: 600;\n            }\n            .discount { color: #dc2626; }\n            .total-row { \n              font-size: 18px; \n              background-color: #1e40af; \n              color: white;\n            }\n            .total-row td { \n              padding: 15px 0; \n              border: none;\n            }\n            \n            /* Footer */\n            .footer { \n              margin-top: 40px; \n              padding-top: 20px; \n              border-top: 1px solid #e5e7eb; \n              text-align: center; \n              color: #6b7280; \n              font-size: 10px;\n            }\n            \n            /* Print Styles */\n            @media print {\n              body { font-size: 11px; }\n              .container { max-width: none; margin: 0; padding: 10px; }\n              .room-section { page-break-inside: avoid; }\n              .summary-section { page-break-inside: avoid; }\n            }\n          </style>\n        </head>\n        <body>\n          <div class=\"container\">\n            <!-- Header -->\n            <div class=\"header\">\n              <div class=\"company-info\">\n                <h1>Kitchen CPQ Solutions</h1>\n                <p>Professional Kitchen Design & Quote System</p>\n                <p>üìß quotes@kitchencpq.com | üìû (555) 123-4567</p>\n              </div>\n              <div class=\"quote-info\">\n                <h2>QUOTE</h2>\n                <p><strong>Quote #:</strong> ${quote.quoteNumber || quote.id}</p>\n                <p><strong>Date:</strong> ${new Date().toLocaleDateString()}</p>\n                <p><strong>Valid Until:</strong> ${new Date(quote.expiresAt).toLocaleDateString()}</p>\n                <p><strong>Status:</strong> ${quote.status.toUpperCase()}</p>\n              </div>\n            </div>\n\n            <!-- Customer Information -->\n            <div class=\"customer-section\">\n              <h3>Customer Information</h3>\n              <div class=\"customer-details\">\n                <div>\n                  <p><strong>Customer:</strong> ${customer.name}</p>\n                  <p><strong>Contract Type:</strong> ${customer.contractId || 'Standard'}</p>\n                </div>\n                <div>\n                  <p><strong>Discount Level:</strong> ${customer.discountPercentage}%</p>\n                  <p><strong>Quote Generated:</strong> ${new Date(quote.createdAt).toLocaleDateString()}</p>\n                </div>\n              </div>\n            </div>\n\n            <!-- Room-based Product Listing -->\n            ${quote.rooms.map(room => {\n      const roomItems = itemsByRoom[room.id] || [];\n      const roomModel = getModel(room.frontModelId);\n      const roomProcessings = room.activatedProcessings.map(id => getProcessing(id)).filter(Boolean);\n      return `\n                <div class=\"room-section\">\n                  <div class=\"room-header\">\n                    <h3>${room.name}</h3>\n                    <p>Style: ${(roomModel === null || roomModel === void 0 ? void 0 : roomModel.name) || 'Unknown'} (${(roomModel === null || roomModel === void 0 ? void 0 : roomModel.category) || 'N/A'})</p>\n                    ${room.description ? `<p>${room.description}</p>` : ''}\n                  </div>\n                  \n                  ${roomProcessings.length > 0 ? `\n                    <div class=\"room-auto-processings\">\n                      <h4>üè† Auto-Applied Room Processings</h4>\n                      <div class=\"auto-processing-list\">\n                        ${roomProcessings.map(processing => `<span class=\"auto-processing-tag\">${(processing === null || processing === void 0 ? void 0 : processing.name) || 'Unknown'}</span>`).join('')}\n                      </div>\n                      <p style=\"margin-top: 8px; font-size: 11px; color: #6b7280;\">\n                        These processings are automatically applied to all applicable products in this room.\n                      </p>\n                    </div>\n                  ` : ''}\n                  \n                  <table class=\"products-table\">\n                    <thead>\n                      <tr>\n                        <th style=\"width: 25%;\">Product</th>\n                        <th style=\"width: 20%;\">Details</th>\n                        <th style=\"width: 10%;\">Qty</th>\n                        <th style=\"width: 15%;\">Base Price</th>\n                        <th style=\"width: 20%;\">Applied Processings</th>\n                        <th style=\"width: 10%;\">Total</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      ${roomItems.map(item => {\n        const product = getProduct(item.productId);\n        const inheritedProcessings = item.appliedProcessings.filter(ap => ap.isInherited);\n        const manualProcessings = item.appliedProcessings.filter(ap => !ap.isInherited);\n        return `\n                          <tr class=\"product-row\">\n                            <td>\n                              <div class=\"product-name\">${(product === null || product === void 0 ? void 0 : product.name) || 'Unknown Product'}</div>\n                              <div class=\"product-category\">${(product === null || product === void 0 ? void 0 : product.category) || 'N/A'}</div>\n                            </td>\n                            <td>\n                              <div style=\"font-size: 11px;\">\n                                ${(product === null || product === void 0 ? void 0 : product.description) || 'No description'}\n                                ${product !== null && product !== void 0 && product.dimensions ? `<br><strong>Dimensions:</strong> ${product.dimensions.width || 'N/A'}\" W √ó ${product.dimensions.height || 'N/A'}\" H √ó ${product.dimensions.depth || 'N/A'}\" D` : ''}\n                              </div>\n                            </td>\n                            <td style=\"text-align: center; font-weight: 600;\">${item.quantity}</td>\n                            <td style=\"text-align: right;\">$${item.basePrice.toFixed(2)}</td>\n                            <td>\n                              <div class=\"processing-details\">\n                                ${inheritedProcessings.map(ap => {\n          const processing = getProcessing(ap.processingId);\n          return `\n                                    <div class=\"processing-item\">\n                                      <span class=\"processing-inherited\">${(processing === null || processing === void 0 ? void 0 : processing.name) || 'Unknown'}</span>\n                                      <span>+$${ap.calculatedPrice.toFixed(2)}</span>\n                                    </div>\n                                  `;\n        }).join('')}\n                                ${manualProcessings.map(ap => {\n          const processing = getProcessing(ap.processingId);\n          return `\n                                    <div class=\"processing-item\">\n                                      <span class=\"processing-manual\">${(processing === null || processing === void 0 ? void 0 : processing.name) || 'Unknown'}</span>\n                                      <span>+$${ap.calculatedPrice.toFixed(2)}</span>\n                                    </div>\n                                  `;\n        }).join('')}\n                                ${item.appliedProcessings.length === 0 ? '<em style=\"color: #9ca3af;\">No processings applied</em>' : ''}\n                              </div>\n                            </td>\n                            <td style=\"text-align: right; font-weight: 600; color: #1f2937;\">$${item.totalPrice.toFixed(2)}</td>\n                          </tr>\n                        `;\n      }).join('')}\n                    </tbody>\n                  </table>\n                </div>\n              `;\n    }).join('')}\n\n            <!-- Quote Summary -->\n            <div class=\"summary-section\">\n              <h3 style=\"margin-bottom: 20px; color: #374151;\">Quote Summary</h3>\n              <table class=\"summary-table\">\n                <tr>\n                  <td class=\"label\">Subtotal:</td>\n                  <td class=\"value\">$${quote.subtotal.toFixed(2)}</td>\n                </tr>\n                ${quote.contractDiscount > 0 ? `\n                <tr>\n                  <td class=\"label\">Contract Discount (${quote.contractDiscount}%):</td>\n                  <td class=\"value discount\">-$${(quote.subtotal * quote.contractDiscount / 100).toFixed(2)}</td>\n                </tr>\n                ` : ''}\n                ${quote.customerDiscount > 0 ? `\n                <tr>\n                  <td class=\"label\">Customer Discount (${quote.customerDiscount}%):</td>\n                  <td class=\"value discount\">-$${((quote.subtotal - quote.subtotal * quote.contractDiscount / 100) * quote.customerDiscount / 100).toFixed(2)}</td>\n                </tr>\n                ` : ''}\n                ${quote.orderDiscount > 0 ? `\n                <tr>\n                  <td class=\"label\">Order Discount:</td>\n                  <td class=\"value discount\">-$${quote.orderDiscount.toFixed(2)}</td>\n                </tr>\n                ` : ''}\n                <tr class=\"total-row\">\n                  <td class=\"label\">FINAL TOTAL:</td>\n                  <td class=\"value\">$${quote.finalTotal.toFixed(2)}</td>\n                </tr>\n              </table>\n              \n              ${quote.notes ? `\n                <div style=\"margin-top: 25px;\">\n                  <h4 style=\"color: #374151; margin-bottom: 10px;\">Additional Notes:</h4>\n                  <p style=\"background: white; padding: 15px; border-radius: 4px; border-left: 4px solid #3b82f6;\">\n                    ${quote.notes}\n                  </p>\n                </div>\n              ` : ''}\n              \n              ${quote.requiresApproval ? `\n                <div style=\"margin-top: 25px; background: #fef3c7; border: 1px solid #f59e0b; padding: 15px; border-radius: 4px;\">\n                  <strong>‚ö†Ô∏è Management Approval Required:</strong> This quote exceeds $${quote.approvalThreshold.toLocaleString()} and requires management approval before proceeding.\n                </div>\n              ` : ''}\n            </div>\n\n            <!-- Footer -->\n            <div class=\"footer\">\n              <p><strong>Legend:</strong> üè† = Auto-applied from room configuration | ‚öôÔ∏è = Product-specific processing</p>\n              <p>This quote is valid until ${new Date(quote.expiresAt).toLocaleDateString()}. Terms and conditions apply.</p>\n              <p>Generated on ${new Date().toLocaleDateString()} at ${new Date().toLocaleTimeString()}</p>\n              <p style=\"margin-top: 10px;\">Thank you for choosing Kitchen CPQ Solutions!</p>\n            </div>\n          </div>\n        </body>\n      </html>\n    `;\n  };\n\n  // Dashboard handlers\n  const handleStartNewQuote = customer => {\n    setWorkflow({\n      currentPhase: 'room_config',\n      // Skip customer selection, go directly to room\n      customer,\n      rooms: [],\n      currentRoomId: null,\n      products: [],\n      quote: null,\n      savedStates: {}\n    });\n    setCurrentView('workflow');\n  };\n  const handleEditQuote = quote => {\n    const customer = customers.find(c => c.id === quote.customerId);\n    if (customer && quote.rooms.length > 0) {\n      setWorkflow({\n        currentPhase: 'quote_finalize',\n        customer,\n        rooms: quote.rooms,\n        currentRoomId: quote.rooms[0].id,\n        products: quote.items,\n        quote,\n        savedStates: {}\n      });\n      setCurrentView('workflow');\n    }\n  };\n  const handleReturnToDashboard = () => {\n    setCurrentView('dashboard');\n    // Reset workflow when returning to dashboard\n    setWorkflow({\n      currentPhase: 'customer_config',\n      customer: null,\n      rooms: [],\n      currentRoomId: null,\n      products: [],\n      quote: null,\n      savedStates: {}\n    });\n  };\n  const handleSaveQuote = () => {\n    console.log('handleSaveQuote called');\n    console.log('workflow.quote:', workflow.quote);\n    if (workflow.quote) {\n      // Ensure quote has all required properties\n      const quoteToSave = {\n        ...workflow.quote,\n        id: workflow.quote.id || Date.now().toString(),\n        quoteNumber: workflow.quote.quoteNumber || `QUOTE-${Date.now()}`,\n        savedAt: new Date(),\n        status: workflow.quote.status || 'draft'\n      };\n      console.log('Saving quote:', quoteToSave);\n\n      // Save to localStorage\n      const existingQuotes = JSON.parse(localStorage.getItem('savedQuotes') || '[]');\n      const updatedQuotes = [...existingQuotes.filter(q => q.id !== quoteToSave.id), quoteToSave];\n      localStorage.setItem('savedQuotes', JSON.stringify(updatedQuotes));\n      console.log('Quotes after save:', updatedQuotes.length);\n      alert('Quote saved successfully!');\n      handleReturnToDashboard();\n    } else {\n      console.log('No quote to save - workflow.quote is null');\n      // Try to create quote if it doesn't exist\n      if (workflow.customer && workflow.rooms.length > 0 && workflow.products.length > 0) {\n        console.log('Creating quote before saving...');\n        createQuoteFromCurrentState();\n\n        // Retry save after creating quote\n        setTimeout(() => {\n          if (workflow.quote) {\n            handleSaveQuote();\n          } else {\n            alert('Error: Unable to create quote for saving');\n          }\n        }, 100);\n      } else {\n        alert('Error: Quote cannot be saved - missing required data');\n      }\n    }\n  };\n  const resetWorkflow = () => {\n    setWorkflow({\n      currentPhase: 'customer_config',\n      customer: null,\n      rooms: [],\n      currentRoomId: null,\n      products: [],\n      quote: null,\n      savedStates: {}\n    });\n  };\n\n  // Get the current room's model\n  const getCurrentRoomModel = () => {\n    const currentRoom = getCurrentRoom();\n    if (!currentRoom) return null;\n    return models.find(m => m.id === currentRoom.frontModelId) || null;\n  };\n\n  // Phase titles and descriptions\n  const phaseInfo = {\n    customer_config: {\n      title: 'Phase 1: Customer Configuration',\n      description: 'Select and configure customer details'\n    },\n    room_config: {\n      title: 'Phase 2: Room Configuration',\n      description: 'Create room and select styling preferences'\n    },\n    product_config: {\n      title: 'Phase 3: Product Configuration',\n      description: 'Select products that inherit room styling'\n    },\n    quote_finalize: {\n      title: 'Phase 4: Quote Finalization',\n      description: 'Review, adjust discounts, and finalize quote'\n    }\n  };\n\n  // Dashboard view\n  if (currentView === 'dashboard') {\n    return /*#__PURE__*/_jsxDEV(MinimalDashboard, {\n      customers: customers,\n      onStartNewQuote: handleStartNewQuote,\n      onEditQuote: handleEditQuote\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 884,\n      columnNumber: 7\n    }, this);\n  }\n\n  // Workflow view\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-gray-50 pb-20\",\n    children: [/*#__PURE__*/_jsxDEV(\"header\", {\n      className: \"bg-white shadow-sm border-b border-gray-200\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-between items-center h-16\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n              className: \"text-2xl font-bold text-gray-900\",\n              children: \"Kitchen CPQ\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 900,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"ml-4 text-sm text-gray-500\",\n              children: \"Improved Workflow\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 901,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 899,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center space-x-2\",\n            children: ['customer_config', 'room_config', 'product_config', 'quote_finalize'].map((phase, index) => {\n              const phaseNames = ['Customer', 'Room', 'Products', 'Quote'];\n              const isActive = workflow.currentPhase === phase;\n              const isCompleted = ['customer_config', 'room_config', 'product_config', 'quote_finalize'].indexOf(workflow.currentPhase) > index;\n              return /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: `w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${isActive ? 'bg-blue-600 text-white' : isCompleted ? 'bg-green-600 text-white' : 'bg-gray-300 text-gray-600'}`,\n                  children: index + 1\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 913,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: `ml-2 text-sm ${isActive ? 'text-blue-600 font-medium' : 'text-gray-500'}`,\n                  children: phaseNames[index]\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 920,\n                  columnNumber: 21\n                }, this), index < 3 && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"w-8 h-0.5 bg-gray-300 mx-3\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 923,\n                  columnNumber: 35\n                }, this)]\n              }, phase, true, {\n                fileName: _jsxFileName,\n                lineNumber: 912,\n                columnNumber: 19\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 905,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-right\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm font-medium text-gray-900\",\n              children: phaseInfo[workflow.currentPhase].title\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 931,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-xs text-gray-500\",\n              children: phaseInfo[workflow.currentPhase].description\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 934,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 930,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 898,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 897,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 896,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex gap-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-1\",\n          children: [workflow.currentPhase === 'customer_config' && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"max-w-4xl mx-auto\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-center mb-8\",\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                className: \"text-3xl font-bold text-gray-900 mb-2\",\n                children: \"Select Customer\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 952,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-gray-600\",\n                children: \"Select customer to start quote process\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 953,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 951,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(CustomerSelector, {\n              customers: customers,\n              contracts: [],\n              onCustomerSelect: handleCustomerSelect\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 956,\n              columnNumber: 13\n            }, this), workflow.customer && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mt-6 bg-green-50 border border-green-200 rounded-lg p-4\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                    className: \"text-lg font-medium text-green-900\",\n                    children: [\"Customer Selected: \", workflow.customer.name]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 966,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"text-sm text-green-700\",\n                    children: [\"Customer Discount: \", workflow.customer.discountPercentage, \"%\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 969,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 965,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex space-x-3\",\n                  children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: saveCurrentPhase,\n                    className: \"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm\",\n                    children: \"Save Customer\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 974,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: proceedToNextPhase,\n                    className: \"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md text-sm\",\n                    children: \"Proceed to Room Setup \\u2192\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 980,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 973,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 964,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 963,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 950,\n            columnNumber: 11\n          }, this), workflow.currentPhase === 'room_config' && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"max-w-4xl mx-auto\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-center mb-8\",\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                className: \"text-3xl font-bold text-gray-900 mb-2\",\n                children: \"Configure Room\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 997,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-gray-600\",\n                children: [\"Customer: \", /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium\",\n                  children: (_workflow$customer = workflow.customer) === null || _workflow$customer === void 0 ? void 0 : _workflow$customer.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 999,\n                  columnNumber: 27\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 998,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 996,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(EnhancedRoomManager, {\n              models: models,\n              processings: processings,\n              onCreateQuote: handleRoomCreate,\n              existingRooms: workflow.rooms,\n              onAddRoom: handleRoomCreate,\n              onEditRoom: handleRoomEdit,\n              onSelectRoom: handleRoomSelect,\n              currentRoomId: workflow.currentRoomId\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1003,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mt-6 flex justify-between\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: goToPreviousPhase,\n                className: \"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-md\",\n                children: \"\\u2190 Back to Customer\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1015,\n                columnNumber: 15\n              }, this), workflow.rooms.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex space-x-3\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: saveCurrentPhase,\n                  className: \"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md\",\n                  children: \"Save Room Config\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1024,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: proceedToNextPhase,\n                  className: \"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md\",\n                  children: \"Proceed to Products \\u2192\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1030,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1023,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1014,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 995,\n            columnNumber: 11\n          }, this), workflow.currentPhase === 'product_config' && workflow.rooms.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-center mb-8\",\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                className: \"text-3xl font-bold text-gray-900 mb-2\",\n                children: \"Configure Products\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1046,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-gray-600\",\n                children: [\"Total Rooms: \", /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium\",\n                  children: workflow.rooms.length\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1048,\n                  columnNumber: 30\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1047,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1045,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-white rounded-lg shadow mb-6 p-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                className: \"text-lg font-semibold text-gray-900 mb-3\",\n                children: \"Select Room to Configure\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1054,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-3\",\n                children: workflow.rooms.map((room, index) => {\n                  const roomModel = models.find(m => m.id === room.frontModelId);\n                  const roomProductCount = workflow.products.filter(p => p.roomId === room.id).length;\n                  const isActive = workflow.currentRoomId === room.id;\n                  return /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: () => handleRoomSelect(room.id),\n                    className: `p-4 rounded-lg border-2 text-left transition-all ${isActive ? 'border-blue-500 bg-blue-50 shadow-md' : 'border-gray-200 hover:border-gray-300 hover:bg-gray-50'}`,\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"flex items-center justify-between mb-2\",\n                      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                        className: `font-semibold ${isActive ? 'text-blue-900' : 'text-gray-900'}`,\n                        children: room.name\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1072,\n                        columnNumber: 25\n                      }, this), isActive && /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full\",\n                        children: \"Active\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1076,\n                        columnNumber: 27\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1071,\n                      columnNumber: 23\n                    }, this), room.description && /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"text-sm text-gray-700 mb-2 italic\",\n                      children: [\"\\\"\", room.description, \"\\\"\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1082,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"text-sm text-gray-600 mb-1\",\n                      children: [\"Style: \", roomModel === null || roomModel === void 0 ? void 0 : roomModel.name]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1086,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"text-sm text-gray-500\",\n                      children: [\"Products: \", roomProductCount]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1089,\n                      columnNumber: 23\n                    }, this)]\n                  }, room.id, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1062,\n                    columnNumber: 21\n                  }, this);\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1055,\n                columnNumber: 15\n              }, this), !workflow.currentRoomId && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg\",\n                children: /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-sm text-yellow-800\",\n                  children: \"\\uD83D\\uDC46 Select a room above to start adding products\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1098,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1097,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1053,\n              columnNumber: 13\n            }, this), workflow.currentRoomId && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"grid grid-cols-1 lg:grid-cols-3 gap-6\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lg:col-span-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"bg-white rounded-lg shadow p-4 mb-4\",\n                  children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                    className: \"text-lg font-semibold text-gray-900 mb-2\",\n                    children: [\"Adding Products to: \", /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-blue-600\",\n                      children: (_getCurrentRoom = getCurrentRoom()) === null || _getCurrentRoom === void 0 ? void 0 : _getCurrentRoom.name\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1111,\n                      columnNumber: 43\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1110,\n                    columnNumber: 21\n                  }, this), ((_getCurrentRoom2 = getCurrentRoom()) === null || _getCurrentRoom2 === void 0 ? void 0 : _getCurrentRoom2.description) && /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"text-sm text-gray-700 mb-2 italic\",\n                    children: [\"Room Description: \\\"\", (_getCurrentRoom3 = getCurrentRoom()) === null || _getCurrentRoom3 === void 0 ? void 0 : _getCurrentRoom3.description, \"\\\"\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1114,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"text-sm text-gray-600\",\n                    children: [\"Style: \", (_getCurrentRoomModel = getCurrentRoomModel()) === null || _getCurrentRoomModel === void 0 ? void 0 : _getCurrentRoomModel.name, \" \\u2022 Products will inherit this room's configuration\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1118,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1109,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(CleanProductCatalog, {\n                  models: models,\n                  products: products,\n                  selectedModel: getCurrentRoomModel(),\n                  onModelSelect: () => {} // Disabled in improved workflow\n                  ,\n                  onProductSelect: (product, quantity) => handleProductAdd(product.id, quantity),\n                  hasQuote: true,\n                  onCreateQuote: () => {}\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1122,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1108,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"space-y-6\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"bg-white rounded-lg shadow p-6\",\n                  children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                    className: \"text-lg font-semibold text-gray-900 mb-4\",\n                    children: [(_getCurrentRoom4 = getCurrentRoom()) === null || _getCurrentRoom4 === void 0 ? void 0 : _getCurrentRoom4.name, \" Products\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1136,\n                    columnNumber: 21\n                  }, this), (() => {\n                    const currentRoomProducts = workflow.products.filter(p => p.roomId === workflow.currentRoomId);\n                    return currentRoomProducts.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"text-center py-6 text-gray-500\",\n                      children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                        className: \"w-12 h-12 mx-auto mb-3 text-gray-300\",\n                        fill: \"none\",\n                        stroke: \"currentColor\",\n                        viewBox: \"0 0 24 24\",\n                        children: /*#__PURE__*/_jsxDEV(\"path\", {\n                          strokeLinecap: \"round\",\n                          strokeLinejoin: \"round\",\n                          strokeWidth: \"2\",\n                          d: \"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1144,\n                          columnNumber: 29\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1143,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                        className: \"text-sm\",\n                        children: \"No products added to this room\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1146,\n                        columnNumber: 27\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1142,\n                      columnNumber: 25\n                    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"space-y-3\",\n                      children: [currentRoomProducts.map(product => {\n                        const productDetails = products.find(p => p.id === product.productId);\n                        return /*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"bg-gray-50 rounded-lg p-3 border border-gray-200\",\n                          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                            className: \"flex justify-between items-start mb-2\",\n                            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                              className: \"flex-1\",\n                              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                                className: \"text-sm font-medium text-gray-900\",\n                                children: productDetails === null || productDetails === void 0 ? void 0 : productDetails.name\n                              }, void 0, false, {\n                                fileName: _jsxFileName,\n                                lineNumber: 1156,\n                                columnNumber: 37\n                              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                                className: \"text-xs text-gray-600\",\n                                children: [\"$\", productDetails === null || productDetails === void 0 ? void 0 : productDetails.basePrice.toFixed(2), \" each\"]\n                              }, void 0, true, {\n                                fileName: _jsxFileName,\n                                lineNumber: 1157,\n                                columnNumber: 37\n                              }, this)]\n                            }, void 0, true, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1155,\n                              columnNumber: 35\n                            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                              onClick: () => removeProduct(product.productId),\n                              className: \"text-red-600 hover:text-red-800 text-xs\",\n                              children: \"Remove\"\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1159,\n                              columnNumber: 35\n                            }, this)]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1154,\n                            columnNumber: 33\n                          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                            className: \"flex items-center justify-between\",\n                            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                              className: \"text-xs text-gray-600\",\n                              children: \"Quantity:\"\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1169,\n                              columnNumber: 35\n                            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                              className: \"flex items-center space-x-2\",\n                              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                                onClick: () => adjustProductQuantity(product.productId, -1),\n                                className: \"w-6 h-6 rounded-full bg-gray-200 hover:bg-gray-300 flex items-center justify-center text-gray-600 text-sm\",\n                                children: \"\\u2212\"\n                              }, void 0, false, {\n                                fileName: _jsxFileName,\n                                lineNumber: 1171,\n                                columnNumber: 37\n                              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                                className: \"text-sm font-medium w-8 text-center\",\n                                children: product.quantity\n                              }, void 0, false, {\n                                fileName: _jsxFileName,\n                                lineNumber: 1177,\n                                columnNumber: 37\n                              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                                onClick: () => adjustProductQuantity(product.productId, 1),\n                                className: \"w-6 h-6 rounded-full bg-blue-600 hover:bg-blue-700 flex items-center justify-center text-white text-sm\",\n                                children: \"+\"\n                              }, void 0, false, {\n                                fileName: _jsxFileName,\n                                lineNumber: 1178,\n                                columnNumber: 37\n                              }, this)]\n                            }, void 0, true, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1170,\n                              columnNumber: 35\n                            }, this)]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1168,\n                            columnNumber: 33\n                          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                            className: \"flex justify-between items-center mt-2 pt-2 border-t border-gray-200\",\n                            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                              className: \"text-xs text-gray-600\",\n                              children: \"Total:\"\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1189,\n                              columnNumber: 35\n                            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                              className: \"text-sm font-semibold text-green-600\",\n                              children: [\"$\", product.totalPrice.toFixed(2)]\n                            }, void 0, true, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1190,\n                              columnNumber: 35\n                            }, this)]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1188,\n                            columnNumber: 33\n                          }, this)]\n                        }, product.id, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1153,\n                          columnNumber: 31\n                        }, this);\n                      }), /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"border-t border-gray-200 pt-3 mt-4\",\n                        children: /*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"flex justify-between text-sm\",\n                          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                            className: \"text-gray-600\",\n                            children: \"Room Total:\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1200,\n                            columnNumber: 31\n                          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                            className: \"font-medium text-green-600\",\n                            children: [\"$\", currentRoomProducts.reduce((sum, product) => sum + product.totalPrice, 0).toFixed(2)]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1201,\n                            columnNumber: 31\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1199,\n                          columnNumber: 29\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1198,\n                        columnNumber: 27\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1149,\n                      columnNumber: 25\n                    }, this);\n                  })()]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1135,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"bg-white rounded-lg shadow p-6\",\n                  children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                    className: \"text-lg font-semibold text-gray-900 mb-4\",\n                    children: \"All Rooms Summary\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1213,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"space-y-3\",\n                    children: [workflow.rooms.map(room => {\n                      const roomProducts = workflow.products.filter(p => p.roomId === room.id);\n                      const roomTotal = roomProducts.reduce((sum, product) => sum + product.totalPrice, 0);\n                      return /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: `p-3 rounded border cursor-pointer transition-colors ${room.id === workflow.currentRoomId ? 'border-blue-500 bg-blue-50' : 'border-gray-200 hover:bg-gray-50'}`,\n                        onClick: () => handleRoomSelect(room.id),\n                        children: /*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"flex justify-between items-center\",\n                          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                              className: \"font-medium text-gray-900\",\n                              children: room.name\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1231,\n                              columnNumber: 33\n                            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                              className: \"text-xs text-gray-600\",\n                              children: [roomProducts.length, \" products\"]\n                            }, void 0, true, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1232,\n                              columnNumber: 33\n                            }, this)]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1230,\n                            columnNumber: 31\n                          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                            className: \"text-right\",\n                            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                              className: \"text-sm font-semibold text-green-600\",\n                              children: [\"$\", roomTotal.toFixed(2)]\n                            }, void 0, true, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1235,\n                              columnNumber: 33\n                            }, this), room.id === workflow.currentRoomId && /*#__PURE__*/_jsxDEV(\"p\", {\n                              className: \"text-xs text-blue-600\",\n                              children: \"Active\"\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1239,\n                              columnNumber: 35\n                            }, this)]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1234,\n                            columnNumber: 31\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1229,\n                          columnNumber: 29\n                        }, this)\n                      }, room.id, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1220,\n                        columnNumber: 27\n                      }, this);\n                    }), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"border-t border-gray-200 pt-3 mt-4\",\n                      children: /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"flex justify-between text-base font-semibold\",\n                        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"text-gray-900\",\n                          children: \"Grand Total:\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1249,\n                          columnNumber: 27\n                        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"text-green-600\",\n                          children: [\"$\", workflow.products.reduce((sum, product) => sum + product.totalPrice, 0).toFixed(2)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1250,\n                          columnNumber: 27\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1248,\n                        columnNumber: 25\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1247,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1214,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1212,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1133,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1107,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mt-6 flex justify-between\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: goToPreviousPhase,\n                className: \"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-md\",\n                children: \"\\u2190 Back to Room Setup\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1262,\n                columnNumber: 15\n              }, this), workflow.products.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex space-x-3\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: saveCurrentPhase,\n                  className: \"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md\",\n                  children: \"Save Product Config\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1271,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: proceedToNextPhase,\n                  className: \"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md\",\n                  children: \"Proceed to Quote \\u2192\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1277,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1270,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1261,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1044,\n            columnNumber: 11\n          }, this), workflow.currentPhase === 'quote_finalize' && workflow.quote && /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-center mb-8\",\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                className: \"text-3xl font-bold text-gray-900 mb-2\",\n                children: \"Finalize Quote\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1293,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-gray-600\",\n                children: \"Review and configure final quote details\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1294,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1292,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(LiveProcessingProductManager, {\n              quote: workflow.quote,\n              rooms: workflow.quote.rooms,\n              products: products,\n              processings: processings,\n              processingRules: processingRules,\n              productDependencies: productDependencies,\n              onQuoteUpdate: handleQuoteUpdate\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1297,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1291,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 946,\n          columnNumber: 11\n        }, this), workflow.currentPhase === 'product_config' && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-80 bg-white rounded-lg shadow-lg p-6 h-fit sticky top-8\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-lg font-semibold text-gray-900 mb-4 flex items-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"w-5 h-5 mr-2 text-blue-600\",\n              fill: \"currentColor\",\n              viewBox: \"0 0 20 20\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                fillRule: \"evenodd\",\n                d: \"M10 2L3 7v11a1 1 0 001 1h3v-8h6v8h3a1 1 0 001-1V7l-7-5z\",\n                clipRule: \"evenodd\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1315,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1314,\n              columnNumber: 17\n            }, this), \"Product Management\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1313,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                className: \"text-sm font-medium text-gray-700 mb-2\",\n                children: \"Quick Room Switch\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1323,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"grid grid-cols-1 gap-2\",\n                children: workflow.rooms.map(room => {\n                  const roomProducts = workflow.products.filter(p => p.roomId === room.id);\n                  const isActive = room.id === workflow.currentRoomId;\n                  return /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: () => handleRoomSelect(room.id),\n                    className: `p-2 rounded text-left text-xs transition-colors ${isActive ? 'bg-blue-100 border-blue-300 text-blue-900' : 'bg-gray-50 border-gray-200 text-gray-700 hover:bg-gray-100'} border`,\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"flex justify-between items-center\",\n                      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"font-medium\",\n                        children: room.name\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1340,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"text-green-600\",\n                        children: roomProducts.length\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1341,\n                        columnNumber: 29\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1339,\n                      columnNumber: 27\n                    }, this)\n                  }, room.id, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1330,\n                    columnNumber: 25\n                  }, this);\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1324,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1322,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                className: \"text-sm font-medium text-gray-700 mb-2\",\n                children: \"Products by Room\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1351,\n                columnNumber: 19\n              }, this), workflow.rooms.map(room => {\n                const roomProducts = workflow.products.filter(p => p.roomId === room.id);\n                const roomTotal = roomProducts.reduce((sum, product) => sum + product.totalPrice, 0);\n                return /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"mb-3\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: `p-2 rounded cursor-pointer transition-colors ${room.id === workflow.currentRoomId ? 'bg-blue-50 border-blue-200' : 'bg-gray-50 border-gray-200 hover:bg-gray-100'} border`,\n                    onClick: () => handleRoomSelect(room.id),\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"flex justify-between items-center mb-1\",\n                      children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n                        className: \"text-sm font-medium text-gray-900\",\n                        children: room.name\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1367,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"text-xs text-green-600 font-medium\",\n                        children: [\"$\", roomTotal.toFixed(2)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1368,\n                        columnNumber: 29\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1366,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"flex justify-between items-center text-xs text-gray-600\",\n                      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                        children: [roomProducts.length, \" products\"]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1373,\n                        columnNumber: 29\n                      }, this), room.id === workflow.currentRoomId && /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"text-blue-600 font-medium\",\n                        children: \"\\u25CF Active\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1375,\n                        columnNumber: 31\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1372,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1358,\n                    columnNumber: 25\n                  }, this), room.id === workflow.currentRoomId && roomProducts.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"mt-2 ml-2 space-y-1\",\n                    children: [roomProducts.slice(0, 3).map(product => {\n                      const productDetails = products.find(p => p.id === product.productId);\n                      return /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"text-xs text-gray-600 flex justify-between\",\n                        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"truncate\",\n                          children: productDetails === null || productDetails === void 0 ? void 0 : productDetails.name\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1387,\n                          columnNumber: 35\n                        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                          children: [\"\\xD7\", product.quantity]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1388,\n                          columnNumber: 35\n                        }, this)]\n                      }, product.id, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1386,\n                        columnNumber: 33\n                      }, this);\n                    }), roomProducts.length > 3 && /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"text-xs text-gray-500\",\n                      children: [\"+\", roomProducts.length - 3, \" more...\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1393,\n                      columnNumber: 31\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1382,\n                    columnNumber: 27\n                  }, this)]\n                }, room.id, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1357,\n                  columnNumber: 23\n                }, this);\n              })]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1350,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"border-t pt-4\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"space-y-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex justify-between text-sm\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-gray-600\",\n                    children: \"Total Rooms:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1408,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"font-medium\",\n                    children: workflow.rooms.length\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1409,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1407,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex justify-between text-sm\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-gray-600\",\n                    children: \"Total Products:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1412,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"font-medium\",\n                    children: workflow.products.length\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1413,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1411,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex justify-between text-sm font-semibold\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-gray-900\",\n                    children: \"Grand Total:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1416,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-green-600\",\n                    children: [\"$\", workflow.products.reduce((sum, product) => sum + product.totalPrice, 0).toFixed(2)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1417,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1415,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1406,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1405,\n              columnNumber: 17\n            }, this), workflow.currentRoomId && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"border-t pt-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                className: \"text-sm font-medium text-gray-700 mb-2\",\n                children: \"Quick Actions\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1427,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"space-y-2\",\n                children: /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => {\n                    var _getCurrentRoom5;\n                    const currentRoomProducts = workflow.products.filter(p => p.roomId === workflow.currentRoomId);\n                    if (currentRoomProducts.length === 0) {\n                      alert('No products to clear in this room');\n                      return;\n                    }\n                    if (confirm(`Clear all ${currentRoomProducts.length} products from ${(_getCurrentRoom5 = getCurrentRoom()) === null || _getCurrentRoom5 === void 0 ? void 0 : _getCurrentRoom5.name}?`)) {\n                      setWorkflow(prev => ({\n                        ...prev,\n                        products: prev.products.filter(p => p.roomId !== workflow.currentRoomId)\n                      }));\n                    }\n                  },\n                  className: \"w-full text-xs bg-red-50 text-red-700 border border-red-200 rounded px-2 py-1 hover:bg-red-100\",\n                  children: \"Clear Room Products\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1429,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1428,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1426,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1320,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1312,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 944,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg z-50\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-between items-center py-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center space-x-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-sm text-gray-600\",\n                children: [\"Phase \", ['customer_config', 'room_config', 'product_config', 'quote_finalize'].indexOf(workflow.currentPhase) + 1, \" of 4\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1460,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"w-32 bg-gray-200 rounded-full h-2\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"bg-blue-600 h-2 rounded-full transition-all duration-300\",\n                  style: {\n                    width: `${(['customer_config', 'room_config', 'product_config', 'quote_finalize'].indexOf(workflow.currentPhase) + 1) / 4 * 100}%`\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1464,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1463,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1459,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex space-x-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: handleReturnToDashboard,\n                className: \"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-md text-sm flex items-center\",\n                children: \"\\uD83C\\uDFE0 Main\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1472,\n                columnNumber: 17\n              }, this), workflow.customer && /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: handleSaveQuote,\n                className: \"bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-md text-sm flex items-center\",\n                children: \"\\uD83D\\uDCBE Save Draft\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1481,\n                columnNumber: 19\n              }, this), workflow.currentPhase !== 'customer_config' && /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: goToPreviousPhase,\n                className: \"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-md text-sm flex items-center\",\n                children: \"\\u2190 Back\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1490,\n                columnNumber: 19\n              }, this), canProceedToNextPhase() && workflow.currentPhase !== 'quote_finalize' && /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: proceedToNextPhase,\n                className: \"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm flex items-center\",\n                children: \"Continue \\u2192\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1499,\n                columnNumber: 19\n              }, this), workflow.currentPhase === 'quote_finalize' && workflow.quote && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex space-x-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: handleSaveQuote,\n                  className: \"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md text-sm\",\n                  children: \"Save & Return\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1509,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => {\n                    // Show preview in new window\n                    const previewWindow = window.open('', '_blank');\n                    if (previewWindow) {\n                      previewWindow.document.write(generateEnhancedPrintHTML());\n                      previewWindow.document.close();\n                    }\n                  },\n                  className: \"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm\",\n                  children: \"Preview Print\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1515,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: printQuote,\n                  className: \"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-md text-sm\",\n                  children: \"Print\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1528,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1508,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1471,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1458,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1457,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1456,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 943,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 894,\n    columnNumber: 5\n  }, this);\n}\n_s(ImprovedApp, \"dW8fY8uMkDa2IMU/HznT6PPK6YQ=\");\n_c = ImprovedApp;\nexport default ImprovedApp;\nvar _c;\n$RefreshReg$(_c, \"ImprovedApp\");","map":{"version":3,"names":["React","useState","useEffect","customers","models","products","processings","processingRules","productDependencies","MinimalDashboard","CustomerSelector","EnhancedRoomManager","CleanProductCatalog","LiveProcessingProductManager","jsxDEV","_jsxDEV","ImprovedApp","_s","_workflow$customer","_getCurrentRoom","_getCurrentRoom2","_getCurrentRoom3","_getCurrentRoomModel","_getCurrentRoom4","currentView","setCurrentView","workflow","setWorkflow","currentPhase","customer","rooms","currentRoomId","quote","savedStates","canProceedToNextPhase","length","proceedToNextPhase","phaseOrder","currentIndex","indexOf","nextPhase","createQuoteFromCurrentState","prev","getCurrentPhaseData","goToPreviousPhase","prevPhase","saveCurrentPhase","currentData","phaseNames","customer_config","room_config","product_config","quote_finalize","alert","newQuote","id","Date","now","toString","customerId","items","contractDiscount","customerDiscount","discountPercentage","orderDiscount","subtotal","totalDiscount","finalTotal","status","createdAt","expiresAt","requiresApproval","approvalThreshold","updatedQuote","recalculateQuote","reduce","sum","item","totalPrice","roomModelIds","map","room","roomModel","find","m","frontModelId","filter","Boolean","compatibleProducts","product","p","productId","includes","modelId","handleCustomerSelect","handleRoomCreate","handleRoomEdit","editedRoom","handleRoomSelect","roomId","getCurrentRoom","handleProductAdd","quantity","currentRoom","inheritedProcessings","activatedProcessings","processingId","processing","applicableProductCategories","category","calculatedPrice","pricingType","price","basePrice","dimensions","dimensionSum","width","height","depth","isInherited","appliedDate","toISOString","newItem","appliedProcessings","handleQuoteUpdate","removeProduct","adjustProductQuantity","change","newQuantity","printQuote","printWindow","window","open","document","write","generateEnhancedPrintHTML","close","print","error","console","getProduct","getModel","getProcessing","itemsByRoom","acc","push","quoteNumber","toLocaleDateString","toUpperCase","name","contractId","roomItems","roomProcessings","description","join","ap","manualProcessings","toFixed","notes","toLocaleString","toLocaleTimeString","handleStartNewQuote","handleEditQuote","c","handleReturnToDashboard","handleSaveQuote","log","quoteToSave","savedAt","existingQuotes","JSON","parse","localStorage","getItem","updatedQuotes","q","setItem","stringify","setTimeout","resetWorkflow","getCurrentRoomModel","phaseInfo","title","onStartNewQuote","onEditQuote","fileName","_jsxFileName","lineNumber","columnNumber","className","children","phase","index","isActive","isCompleted","contracts","onCustomerSelect","onClick","onCreateQuote","existingRooms","onAddRoom","onEditRoom","onSelectRoom","roomProductCount","selectedModel","onModelSelect","onProductSelect","hasQuote","currentRoomProducts","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","productDetails","roomProducts","roomTotal","onQuoteUpdate","fillRule","clipRule","slice","_getCurrentRoom5","confirm","style","previewWindow","_c","$RefreshReg$"],"sources":["/Users/dkjesuschua/Documents/demo_cpq/src/ImprovedApp.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Quote, Customer, Room, QuoteItem } from './types';\nimport { customers, models, products, processings, processingRules, productDependencies } from './data/sampleData';\nimport MinimalDashboard from './components/MinimalDashboard';\nimport CustomerSelector from './components/CustomerSelector';\nimport EnhancedRoomManager from './components/EnhancedRoomManager';\nimport CleanProductCatalog from './components/CleanProductCatalog';\nimport LiveProcessingProductManager from './components/LiveProcessingProductManager';\n\n// Define the 4 clear phases\ntype WorkflowPhase = 'customer_config' | 'room_config' | 'product_config' | 'quote_finalize';\ntype AppView = 'dashboard' | 'workflow';\n\ninterface WorkflowState {\n  currentPhase: WorkflowPhase;\n  customer: Customer | null;\n  rooms: Room[];\n  currentRoomId: string | null; // Track which room is currently being configured\n  products: Quote['items'];\n  quote: Quote | null;\n  savedStates: {\n    customer?: Customer;\n    rooms?: Room[];\n    products?: Quote['items'];\n  };\n}\n\nfunction ImprovedApp() {\n  const [currentView, setCurrentView] = useState<AppView>('dashboard');\n  const [workflow, setWorkflow] = useState<WorkflowState>({\n    currentPhase: 'customer_config',\n    customer: null,\n    rooms: [],\n    currentRoomId: null,\n    products: [],\n    quote: null,\n    savedStates: {}\n  });\n\n  // Phase progression with validation\n  const canProceedToNextPhase = () => {\n    switch (workflow.currentPhase) {\n      case 'customer_config': return workflow.customer !== null;\n      case 'room_config': return workflow.rooms.length > 0;\n      case 'product_config': {\n        // Ensure there's at least one product total (can be lenient about all rooms having products)\n        return workflow.products.length > 0;\n      }\n      case 'quote_finalize': return workflow.quote !== null;\n      default: return false;\n    }\n  };\n\n  const proceedToNextPhase = () => {\n    const phaseOrder: WorkflowPhase[] = ['customer_config', 'room_config', 'product_config', 'quote_finalize'];\n    const currentIndex = phaseOrder.indexOf(workflow.currentPhase);\n    \n    if (currentIndex < phaseOrder.length - 1 && canProceedToNextPhase()) {\n      const nextPhase = phaseOrder[currentIndex + 1];\n      \n      // Auto-create quote when moving to product config\n      if (nextPhase === 'product_config' && !workflow.quote) {\n        createQuoteFromCurrentState();\n      }\n      \n      // Update quote when moving to quote finalization\n      if (nextPhase === 'quote_finalize') {\n        createQuoteFromCurrentState();\n      }\n      \n      setWorkflow(prev => ({\n        ...prev,\n        currentPhase: nextPhase,\n        savedStates: {\n          ...prev.savedStates,\n          [prev.currentPhase]: getCurrentPhaseData()\n        }\n      }));\n    }\n  };\n\n  const goToPreviousPhase = () => {\n    const phaseOrder: WorkflowPhase[] = ['customer_config', 'room_config', 'product_config', 'quote_finalize'];\n    const currentIndex = phaseOrder.indexOf(workflow.currentPhase);\n    \n    if (currentIndex > 0) {\n      const prevPhase = phaseOrder[currentIndex - 1];\n      setWorkflow(prev => ({ ...prev, currentPhase: prevPhase }));\n    }\n  };\n\n  const getCurrentPhaseData = () => {\n    switch (workflow.currentPhase) {\n      case 'customer_config': return workflow.customer;\n      case 'room_config': return workflow.rooms;\n      case 'product_config': return workflow.products;\n      case 'quote_finalize': return workflow.quote;\n      default: return null;\n    }\n  };\n\n  // Save current phase state\n  const saveCurrentPhase = () => {\n    const currentData = getCurrentPhaseData();\n    setWorkflow(prev => ({\n      ...prev,\n      savedStates: {\n        ...prev.savedStates,\n        [prev.currentPhase]: currentData\n      }\n    }));\n    \n    // Show save confirmation\n    const phaseNames = {\n      customer_config: 'Customer Configuration',\n      room_config: 'Room Configuration', \n      product_config: 'Product Configuration',\n      quote_finalize: 'Quote'\n    };\n    alert(`${phaseNames[workflow.currentPhase]} saved successfully!`);\n  };\n\n  // Create quote from current state\n  const createQuoteFromCurrentState = () => {\n    if (!workflow.customer || workflow.rooms.length === 0) return;\n\n    const newQuote: Quote = {\n      id: Date.now().toString(),\n      customerId: workflow.customer.id,\n      rooms: workflow.rooms,\n      items: workflow.products,\n      contractDiscount: 0,\n      customerDiscount: workflow.customer.discountPercentage || 0,\n      orderDiscount: 0,\n      subtotal: 0,\n      totalDiscount: 0,\n      finalTotal: 0,\n      status: 'draft',\n      createdAt: new Date(),\n      expiresAt: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000),\n      requiresApproval: false,\n      approvalThreshold: 5000\n    };\n\n    const updatedQuote = recalculateQuote(newQuote);\n    setWorkflow(prev => ({ ...prev, quote: updatedQuote }));\n  };\n\n  // Recalculate quote totals\n  const recalculateQuote = (quote: Quote): Quote => {\n    const subtotal = quote.items.reduce((sum, item) => sum + item.totalPrice, 0);\n    const customerDiscount = subtotal * (quote.customerDiscount / 100);\n    const totalDiscount = customerDiscount + quote.orderDiscount;\n    const finalTotal = subtotal - totalDiscount;\n\n    return {\n      ...quote,\n      subtotal,\n      totalDiscount,\n      finalTotal,\n      requiresApproval: finalTotal > quote.approvalThreshold\n    };\n  };\n\n  // Cascading updates when stepping back\n  useEffect(() => {\n    // If customer changes, clear rooms and products\n    if (workflow.currentPhase === 'customer_config' && workflow.rooms.length > 0) {\n      setWorkflow(prev => ({ ...prev, rooms: [], currentRoomId: null, products: [], quote: null }));\n    }\n    \n    // If rooms change, clear products that don't match any room's model\n    if (workflow.currentPhase === 'room_config' && workflow.rooms.length > 0 && workflow.products.length > 0) {\n      const roomModelIds = workflow.rooms.map(room => {\n        const roomModel = models.find(m => m.id === room.frontModelId);\n        return roomModel?.id;\n      }).filter(Boolean);\n      \n      if (roomModelIds.length > 0) {\n        const compatibleProducts = workflow.products.filter(item => {\n          const product = products.find(p => p.id === item.productId);\n          return product && roomModelIds.includes(product.modelId);\n        });\n        \n        if (compatibleProducts.length !== workflow.products.length) {\n          setWorkflow(prev => ({ \n            ...prev, \n            products: compatibleProducts,\n            quote: null // Clear quote to force recalculation\n          }));\n        }\n      }\n    }\n\n    // Auto-select first room when entering product config phase\n    if (workflow.currentPhase === 'product_config' && workflow.rooms.length > 0 && !workflow.currentRoomId) {\n      setWorkflow(prev => ({ ...prev, currentRoomId: prev.rooms[0].id }));\n    }\n  }, [workflow.customer, workflow.rooms, workflow.currentPhase, workflow.products, workflow.currentRoomId]);\n\n  // Phase-specific handlers\n  const handleCustomerSelect = (customer: Customer) => {\n    setWorkflow(prev => ({ ...prev, customer }));\n  };\n\n  const handleRoomCreate = (room: Room) => {\n    setWorkflow(prev => ({ \n      ...prev, \n      rooms: [...prev.rooms, room],\n      currentRoomId: room.id\n    }));\n  };\n\n  const handleRoomEdit = (editedRoom: Room) => {\n    setWorkflow(prev => ({\n      ...prev,\n      rooms: prev.rooms.map(room => \n        room.id === editedRoom.id ? editedRoom : room\n      )\n    }));\n  };\n\n  const handleRoomSelect = (roomId: string) => {\n    setWorkflow(prev => ({\n      ...prev,\n      currentRoomId: roomId\n    }));\n  };\n\n  // Helper function to get the current room\n  const getCurrentRoom = (): Room | null => {\n    if (workflow.currentRoomId) {\n      return workflow.rooms.find(room => room.id === workflow.currentRoomId) || null;\n    }\n    // If no specific room is selected, return the last added room\n    return workflow.rooms.length > 0 ? workflow.rooms[workflow.rooms.length - 1] : null;\n  };\n\n  const handleProductAdd = (productId: string, quantity: number = 1) => {\n    const currentRoom = getCurrentRoom();\n    if (!currentRoom) return;\n\n    const product = products.find(p => p.id === productId);\n    if (!product) return;\n\n    // Apply room-level inherited processings\n    const inheritedProcessings = currentRoom.activatedProcessings\n      .map((processingId: string) => {\n        const processing = processings.find(p => p.id === processingId);\n        if (!processing) return null;\n        \n        // Check if this processing is applicable to this product category\n        if (!processing.applicableProductCategories.includes(product.category)) {\n          return null;\n        }\n\n        let calculatedPrice = 0;\n        if (processing.pricingType === 'per_unit') {\n          calculatedPrice = processing.price * quantity;\n        } else if (processing.pricingType === 'percentage') {\n          calculatedPrice = (product.basePrice * quantity) * (processing.price / 100);\n        } else if (processing.pricingType === 'per_dimension' && product.dimensions) {\n          // Basic dimension calculation - can be enhanced with formula evaluation\n          const dimensionSum = (product.dimensions.width || 0) + \n                               (product.dimensions.height || 0) + \n                               (product.dimensions.depth || 0);\n          calculatedPrice = dimensionSum * processing.price * quantity;\n        }\n\n        return {\n          processingId: processing.id,\n          calculatedPrice,\n          isInherited: true,\n          appliedDate: new Date().toISOString()\n        };\n      })\n      .filter(Boolean);\n\n    const newItem: QuoteItem = {\n      id: Date.now().toString(),\n      productId,\n      roomId: currentRoom.id,\n      quantity,\n      appliedProcessings: inheritedProcessings as any[],\n      basePrice: product.basePrice,\n      totalPrice: (product.basePrice * quantity) + inheritedProcessings.reduce((sum, p) => sum + (p?.calculatedPrice || 0), 0)\n    };\n\n    setWorkflow(prev => ({\n      ...prev,\n      products: [...prev.products, newItem]\n    }));\n  };\n\n  const handleQuoteUpdate = (updatedQuote: Quote) => {\n    setWorkflow(prev => ({ ...prev, quote: updatedQuote }));\n  };\n\n  // Remove product from workflow\n  const removeProduct = (productId: string) => {\n    setWorkflow(prev => ({\n      ...prev,\n      products: prev.products.filter(item => item.productId !== productId)\n    }));\n  };\n\n  const adjustProductQuantity = (productId: string, change: number) => {\n    setWorkflow(prev => ({\n      ...prev,\n      products: prev.products.map(item => {\n        if (item.productId === productId) {\n          const newQuantity = item.quantity + change;\n          return { ...item, quantity: newQuantity };\n        }\n        return item;\n      }).filter(item => item.quantity > 0) // Remove items with 0 or negative quantity\n    }));\n  };\n\n  // Print quote - Enhanced professional print functionality\n  const printQuote = () => {\n    if (!workflow.quote || !workflow.customer) {\n      alert('No quote available to print.');\n      return;\n    }\n\n    try {\n      // Create a new window for printing\n      const printWindow = window.open('', '_blank');\n      if (printWindow) {\n        printWindow.document.write(generateEnhancedPrintHTML());\n        printWindow.document.close();\n        printWindow.print();\n        printWindow.close();\n      }\n    } catch (error) {\n      console.error('Print failed:', error);\n      alert('Print functionality is not available in this browser.');\n    }\n  };\n\n  // Generate enhanced HTML for professional quote printing\n  const generateEnhancedPrintHTML = () => {\n    const quote = workflow.quote!;\n    const customer = workflow.customer!;\n    \n    const getProduct = (productId: string) => products.find(p => p.id === productId);\n    const getModel = (modelId: string) => models.find(m => m.id === modelId);\n    const getProcessing = (processingId: string) => processings.find(p => p.id === processingId);\n    \n    // Group items by room\n    const itemsByRoom = quote.items.reduce((acc, item) => {\n      const roomId = item.roomId;\n      if (!acc[roomId]) {\n        acc[roomId] = [];\n      }\n      acc[roomId].push(item);\n      return acc;\n    }, {} as Record<string, any[]>);\n\n    return `\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <title>Professional Quote - ${quote.quoteNumber || quote.id}</title>\n          <meta charset=\"UTF-8\">\n          <style>\n            * { margin: 0; padding: 0; box-sizing: border-box; }\n            body { \n              font-family: 'Arial', sans-serif; \n              line-height: 1.6; \n              color: #333; \n              background: white;\n              font-size: 12px;\n            }\n            .container { max-width: 800px; margin: 0 auto; padding: 20px; }\n            \n            /* Header Styles */\n            .header { \n              border-bottom: 3px solid #2563eb; \n              padding-bottom: 20px; \n              margin-bottom: 30px; \n              display: flex;\n              justify-content: space-between;\n              align-items: flex-start;\n            }\n            .company-info h1 { \n              font-size: 28px; \n              font-weight: bold; \n              color: #2563eb; \n              margin-bottom: 5px;\n            }\n            .company-info p { color: #666; font-size: 14px; }\n            .quote-info { text-align: right; }\n            .quote-info h2 { \n              font-size: 24px; \n              color: #1f2937; \n              margin-bottom: 10px;\n            }\n            .quote-info p { margin-bottom: 5px; }\n            \n            /* Customer Section */\n            .customer-section { \n              background-color: #f8fafc; \n              padding: 20px; \n              border-radius: 8px; \n              margin-bottom: 30px; \n            }\n            .customer-section h3 { \n              font-size: 18px; \n              color: #374151; \n              margin-bottom: 15px;\n              border-bottom: 1px solid #d1d5db;\n              padding-bottom: 5px;\n            }\n            .customer-details { \n              display: grid; \n              grid-template-columns: 1fr 1fr; \n              gap: 15px; \n            }\n            \n            /* Room Sections */\n            .room-section { \n              margin-bottom: 40px; \n              border: 1px solid #e5e7eb;\n              border-radius: 8px;\n              overflow: hidden;\n            }\n            .room-header { \n              background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%); \n              color: white; \n              padding: 15px 20px; \n            }\n            .room-header h3 { font-size: 20px; margin-bottom: 5px; }\n            .room-header p { opacity: 0.9; }\n            .room-auto-processings { \n              background-color: #eff6ff; \n              padding: 15px 20px; \n              border-bottom: 1px solid #e5e7eb;\n            }\n            .room-auto-processings h4 { \n              color: #1e40af; \n              margin-bottom: 10px;\n              font-size: 14px;\n            }\n            .auto-processing-list { \n              display: flex; \n              flex-wrap: wrap; \n              gap: 8px; \n            }\n            .auto-processing-tag { \n              background-color: #dbeafe; \n              color: #1e40af; \n              padding: 4px 8px; \n              border-radius: 4px; \n              font-size: 11px;\n              font-weight: 500;\n            }\n            \n            /* Product Tables */\n            .products-table { \n              width: 100%; \n              border-collapse: collapse; \n            }\n            .products-table th { \n              background-color: #f9fafb; \n              padding: 12px; \n              text-align: left; \n              font-weight: 600;\n              border-bottom: 2px solid #e5e7eb;\n              font-size: 11px;\n              text-transform: uppercase;\n              letter-spacing: 0.5px;\n            }\n            .products-table td { \n              padding: 12px; \n              border-bottom: 1px solid #f3f4f6; \n              vertical-align: top;\n            }\n            .product-row:hover { background-color: #fafafa; }\n            .product-name { font-weight: 600; color: #1f2937; }\n            .product-category { \n              color: #6b7280; \n              font-size: 10px; \n              text-transform: uppercase;\n            }\n            \n            /* Processing Details */\n            .processing-details { \n              margin-top: 8px; \n            }\n            .processing-item { \n              display: flex; \n              justify-content: space-between; \n              align-items: center;\n              padding: 4px 0;\n              font-size: 11px;\n            }\n            .processing-inherited { \n              color: #059669; \n              font-weight: 500;\n            }\n            .processing-inherited::before { \n              content: \"üè† \"; \n            }\n            .processing-manual { \n              color: #7c3aed; \n              font-weight: 500;\n            }\n            .processing-manual::before { \n              content: \"‚öôÔ∏è \"; \n            }\n            \n            /* Summary Section */\n            .summary-section { \n              margin-top: 40px; \n              background-color: #f8fafc; \n              padding: 25px; \n              border-radius: 8px;\n            }\n            .summary-table { \n              width: 100%; \n              border-collapse: collapse; \n            }\n            .summary-table td { \n              padding: 8px 0; \n              border-bottom: 1px solid #e5e7eb;\n            }\n            .summary-table .label { font-weight: 600; }\n            .summary-table .value { \n              text-align: right; \n              font-weight: 600;\n            }\n            .discount { color: #dc2626; }\n            .total-row { \n              font-size: 18px; \n              background-color: #1e40af; \n              color: white;\n            }\n            .total-row td { \n              padding: 15px 0; \n              border: none;\n            }\n            \n            /* Footer */\n            .footer { \n              margin-top: 40px; \n              padding-top: 20px; \n              border-top: 1px solid #e5e7eb; \n              text-align: center; \n              color: #6b7280; \n              font-size: 10px;\n            }\n            \n            /* Print Styles */\n            @media print {\n              body { font-size: 11px; }\n              .container { max-width: none; margin: 0; padding: 10px; }\n              .room-section { page-break-inside: avoid; }\n              .summary-section { page-break-inside: avoid; }\n            }\n          </style>\n        </head>\n        <body>\n          <div class=\"container\">\n            <!-- Header -->\n            <div class=\"header\">\n              <div class=\"company-info\">\n                <h1>Kitchen CPQ Solutions</h1>\n                <p>Professional Kitchen Design & Quote System</p>\n                <p>üìß quotes@kitchencpq.com | üìû (555) 123-4567</p>\n              </div>\n              <div class=\"quote-info\">\n                <h2>QUOTE</h2>\n                <p><strong>Quote #:</strong> ${quote.quoteNumber || quote.id}</p>\n                <p><strong>Date:</strong> ${new Date().toLocaleDateString()}</p>\n                <p><strong>Valid Until:</strong> ${new Date(quote.expiresAt).toLocaleDateString()}</p>\n                <p><strong>Status:</strong> ${quote.status.toUpperCase()}</p>\n              </div>\n            </div>\n\n            <!-- Customer Information -->\n            <div class=\"customer-section\">\n              <h3>Customer Information</h3>\n              <div class=\"customer-details\">\n                <div>\n                  <p><strong>Customer:</strong> ${customer.name}</p>\n                  <p><strong>Contract Type:</strong> ${customer.contractId || 'Standard'}</p>\n                </div>\n                <div>\n                  <p><strong>Discount Level:</strong> ${customer.discountPercentage}%</p>\n                  <p><strong>Quote Generated:</strong> ${new Date(quote.createdAt).toLocaleDateString()}</p>\n                </div>\n              </div>\n            </div>\n\n            <!-- Room-based Product Listing -->\n            ${quote.rooms.map(room => {\n              const roomItems = itemsByRoom[room.id] || [];\n              const roomModel = getModel(room.frontModelId);\n              const roomProcessings = room.activatedProcessings\n                .map(id => getProcessing(id))\n                .filter(Boolean);\n              \n              return `\n                <div class=\"room-section\">\n                  <div class=\"room-header\">\n                    <h3>${room.name}</h3>\n                    <p>Style: ${roomModel?.name || 'Unknown'} (${roomModel?.category || 'N/A'})</p>\n                    ${room.description ? `<p>${room.description}</p>` : ''}\n                  </div>\n                  \n                  ${roomProcessings.length > 0 ? `\n                    <div class=\"room-auto-processings\">\n                      <h4>üè† Auto-Applied Room Processings</h4>\n                      <div class=\"auto-processing-list\">\n                        ${roomProcessings.map(processing => \n                          `<span class=\"auto-processing-tag\">${processing?.name || 'Unknown'}</span>`\n                        ).join('')}\n                      </div>\n                      <p style=\"margin-top: 8px; font-size: 11px; color: #6b7280;\">\n                        These processings are automatically applied to all applicable products in this room.\n                      </p>\n                    </div>\n                  ` : ''}\n                  \n                  <table class=\"products-table\">\n                    <thead>\n                      <tr>\n                        <th style=\"width: 25%;\">Product</th>\n                        <th style=\"width: 20%;\">Details</th>\n                        <th style=\"width: 10%;\">Qty</th>\n                        <th style=\"width: 15%;\">Base Price</th>\n                        <th style=\"width: 20%;\">Applied Processings</th>\n                        <th style=\"width: 10%;\">Total</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      ${roomItems.map(item => {\n                        const product = getProduct(item.productId);\n                        const inheritedProcessings = item.appliedProcessings.filter((ap: any) => ap.isInherited);\n                        const manualProcessings = item.appliedProcessings.filter((ap: any) => !ap.isInherited);\n                        \n                        return `\n                          <tr class=\"product-row\">\n                            <td>\n                              <div class=\"product-name\">${product?.name || 'Unknown Product'}</div>\n                              <div class=\"product-category\">${product?.category || 'N/A'}</div>\n                            </td>\n                            <td>\n                              <div style=\"font-size: 11px;\">\n                                ${product?.description || 'No description'}\n                                ${product?.dimensions ? `<br><strong>Dimensions:</strong> ${product.dimensions.width || 'N/A'}\" W √ó ${product.dimensions.height || 'N/A'}\" H √ó ${product.dimensions.depth || 'N/A'}\" D` : ''}\n                              </div>\n                            </td>\n                            <td style=\"text-align: center; font-weight: 600;\">${item.quantity}</td>\n                            <td style=\"text-align: right;\">$${item.basePrice.toFixed(2)}</td>\n                            <td>\n                              <div class=\"processing-details\">\n                                ${inheritedProcessings.map((ap: any) => {\n                                  const processing = getProcessing(ap.processingId);\n                                  return `\n                                    <div class=\"processing-item\">\n                                      <span class=\"processing-inherited\">${processing?.name || 'Unknown'}</span>\n                                      <span>+$${ap.calculatedPrice.toFixed(2)}</span>\n                                    </div>\n                                  `;\n                                }).join('')}\n                                ${manualProcessings.map((ap: any) => {\n                                  const processing = getProcessing(ap.processingId);\n                                  return `\n                                    <div class=\"processing-item\">\n                                      <span class=\"processing-manual\">${processing?.name || 'Unknown'}</span>\n                                      <span>+$${ap.calculatedPrice.toFixed(2)}</span>\n                                    </div>\n                                  `;\n                                }).join('')}\n                                ${item.appliedProcessings.length === 0 ? '<em style=\"color: #9ca3af;\">No processings applied</em>' : ''}\n                              </div>\n                            </td>\n                            <td style=\"text-align: right; font-weight: 600; color: #1f2937;\">$${item.totalPrice.toFixed(2)}</td>\n                          </tr>\n                        `;\n                      }).join('')}\n                    </tbody>\n                  </table>\n                </div>\n              `;\n            }).join('')}\n\n            <!-- Quote Summary -->\n            <div class=\"summary-section\">\n              <h3 style=\"margin-bottom: 20px; color: #374151;\">Quote Summary</h3>\n              <table class=\"summary-table\">\n                <tr>\n                  <td class=\"label\">Subtotal:</td>\n                  <td class=\"value\">$${quote.subtotal.toFixed(2)}</td>\n                </tr>\n                ${quote.contractDiscount > 0 ? `\n                <tr>\n                  <td class=\"label\">Contract Discount (${quote.contractDiscount}%):</td>\n                  <td class=\"value discount\">-$${(quote.subtotal * quote.contractDiscount / 100).toFixed(2)}</td>\n                </tr>\n                ` : ''}\n                ${quote.customerDiscount > 0 ? `\n                <tr>\n                  <td class=\"label\">Customer Discount (${quote.customerDiscount}%):</td>\n                  <td class=\"value discount\">-$${((quote.subtotal - quote.subtotal * quote.contractDiscount / 100) * quote.customerDiscount / 100).toFixed(2)}</td>\n                </tr>\n                ` : ''}\n                ${quote.orderDiscount > 0 ? `\n                <tr>\n                  <td class=\"label\">Order Discount:</td>\n                  <td class=\"value discount\">-$${quote.orderDiscount.toFixed(2)}</td>\n                </tr>\n                ` : ''}\n                <tr class=\"total-row\">\n                  <td class=\"label\">FINAL TOTAL:</td>\n                  <td class=\"value\">$${quote.finalTotal.toFixed(2)}</td>\n                </tr>\n              </table>\n              \n              ${quote.notes ? `\n                <div style=\"margin-top: 25px;\">\n                  <h4 style=\"color: #374151; margin-bottom: 10px;\">Additional Notes:</h4>\n                  <p style=\"background: white; padding: 15px; border-radius: 4px; border-left: 4px solid #3b82f6;\">\n                    ${quote.notes}\n                  </p>\n                </div>\n              ` : ''}\n              \n              ${quote.requiresApproval ? `\n                <div style=\"margin-top: 25px; background: #fef3c7; border: 1px solid #f59e0b; padding: 15px; border-radius: 4px;\">\n                  <strong>‚ö†Ô∏è Management Approval Required:</strong> This quote exceeds $${quote.approvalThreshold.toLocaleString()} and requires management approval before proceeding.\n                </div>\n              ` : ''}\n            </div>\n\n            <!-- Footer -->\n            <div class=\"footer\">\n              <p><strong>Legend:</strong> üè† = Auto-applied from room configuration | ‚öôÔ∏è = Product-specific processing</p>\n              <p>This quote is valid until ${new Date(quote.expiresAt).toLocaleDateString()}. Terms and conditions apply.</p>\n              <p>Generated on ${new Date().toLocaleDateString()} at ${new Date().toLocaleTimeString()}</p>\n              <p style=\"margin-top: 10px;\">Thank you for choosing Kitchen CPQ Solutions!</p>\n            </div>\n          </div>\n        </body>\n      </html>\n    `;\n  };\n\n  // Dashboard handlers\n  const handleStartNewQuote = (customer: Customer) => {\n    setWorkflow({\n      currentPhase: 'room_config', // Skip customer selection, go directly to room\n      customer,\n      rooms: [],\n      currentRoomId: null,\n      products: [],\n      quote: null,\n      savedStates: {}\n    });\n    setCurrentView('workflow');\n  };\n\n  const handleEditQuote = (quote: Quote) => {\n    const customer = customers.find(c => c.id === quote.customerId);\n    if (customer && quote.rooms.length > 0) {\n      setWorkflow({\n        currentPhase: 'quote_finalize',\n        customer,\n        rooms: quote.rooms,\n        currentRoomId: quote.rooms[0].id,\n        products: quote.items,\n        quote,\n        savedStates: {}\n      });\n      setCurrentView('workflow');\n    }\n  };\n\n  const handleReturnToDashboard = () => {\n    setCurrentView('dashboard');\n    // Reset workflow when returning to dashboard\n    setWorkflow({\n      currentPhase: 'customer_config',\n      customer: null,\n      rooms: [],\n      currentRoomId: null,\n      products: [],\n      quote: null,\n      savedStates: {}\n    });\n  };\n\n  const handleSaveQuote = () => {\n    console.log('handleSaveQuote called');\n    console.log('workflow.quote:', workflow.quote);\n    \n    if (workflow.quote) {\n      // Ensure quote has all required properties\n      const quoteToSave = {\n        ...workflow.quote,\n        id: workflow.quote.id || Date.now().toString(),\n        quoteNumber: workflow.quote.quoteNumber || `QUOTE-${Date.now()}`,\n        savedAt: new Date(),\n        status: workflow.quote.status || 'draft'\n      };\n      \n      console.log('Saving quote:', quoteToSave);\n      \n      // Save to localStorage\n      const existingQuotes = JSON.parse(localStorage.getItem('savedQuotes') || '[]');\n      const updatedQuotes = [...existingQuotes.filter((q: Quote) => q.id !== quoteToSave.id), quoteToSave];\n      localStorage.setItem('savedQuotes', JSON.stringify(updatedQuotes));\n      \n      console.log('Quotes after save:', updatedQuotes.length);\n      \n      alert('Quote saved successfully!');\n      handleReturnToDashboard();\n    } else {\n      console.log('No quote to save - workflow.quote is null');\n      // Try to create quote if it doesn't exist\n      if (workflow.customer && workflow.rooms.length > 0 && workflow.products.length > 0) {\n        console.log('Creating quote before saving...');\n        createQuoteFromCurrentState();\n        \n        // Retry save after creating quote\n        setTimeout(() => {\n          if (workflow.quote) {\n            handleSaveQuote();\n          } else {\n            alert('Error: Unable to create quote for saving');\n          }\n        }, 100);\n      } else {\n        alert('Error: Quote cannot be saved - missing required data');\n      }\n    }\n  };\n\n  const resetWorkflow = () => {\n    setWorkflow({\n      currentPhase: 'customer_config',\n      customer: null,\n      rooms: [],\n      currentRoomId: null,\n      products: [],\n      quote: null,\n      savedStates: {}\n    });\n  };\n\n  // Get the current room's model\n  const getCurrentRoomModel = () => {\n    const currentRoom = getCurrentRoom();\n    if (!currentRoom) return null;\n    return models.find(m => m.id === currentRoom.frontModelId) || null;\n  };\n\n  // Phase titles and descriptions\n  const phaseInfo = {\n    customer_config: {\n      title: 'Phase 1: Customer Configuration',\n      description: 'Select and configure customer details'\n    },\n    room_config: {\n      title: 'Phase 2: Room Configuration', \n      description: 'Create room and select styling preferences'\n    },\n    product_config: {\n      title: 'Phase 3: Product Configuration',\n      description: 'Select products that inherit room styling'\n    },\n    quote_finalize: {\n      title: 'Phase 4: Quote Finalization',\n      description: 'Review, adjust discounts, and finalize quote'\n    }\n  };\n\n  // Dashboard view\n  if (currentView === 'dashboard') {\n    return (\n      <MinimalDashboard\n        customers={customers}\n        onStartNewQuote={handleStartNewQuote}\n        onEditQuote={handleEditQuote}\n      />\n    );\n  }\n\n  // Workflow view\n  return (\n    <div className=\"min-h-screen bg-gray-50 pb-20\">\n      {/* Header with Phase Progression */}\n      <header className=\"bg-white shadow-sm border-b border-gray-200\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex justify-between items-center h-16\">\n            <div className=\"flex items-center\">\n              <h1 className=\"text-2xl font-bold text-gray-900\">Kitchen CPQ</h1>\n              <span className=\"ml-4 text-sm text-gray-500\">Improved Workflow</span>\n            </div>\n            \n            {/* Phase Progress Indicator */}\n            <div className=\"flex items-center space-x-2\">\n              {(['customer_config', 'room_config', 'product_config', 'quote_finalize'] as WorkflowPhase[]).map((phase, index) => {\n                const phaseNames = ['Customer', 'Room', 'Products', 'Quote'];\n                const isActive = workflow.currentPhase === phase;\n                const isCompleted = (['customer_config', 'room_config', 'product_config', 'quote_finalize'] as WorkflowPhase[]).indexOf(workflow.currentPhase) > index;\n                \n                return (\n                  <div key={phase} className=\"flex items-center\">\n                    <div className={`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${\n                      isActive ? 'bg-blue-600 text-white' :\n                      isCompleted ? 'bg-green-600 text-white' :\n                      'bg-gray-300 text-gray-600'\n                    }`}>\n                      {index + 1}\n                    </div>\n                    <span className={`ml-2 text-sm ${isActive ? 'text-blue-600 font-medium' : 'text-gray-500'}`}>\n                      {phaseNames[index]}\n                    </span>\n                    {index < 3 && <div className=\"w-8 h-0.5 bg-gray-300 mx-3\" />}\n                  </div>\n                );\n              })}\n            </div>\n\n            {/* Current Phase Info */}\n            <div className=\"text-right\">\n              <div className=\"text-sm font-medium text-gray-900\">\n                {phaseInfo[workflow.currentPhase].title}\n              </div>\n              <div className=\"text-xs text-gray-500\">\n                {phaseInfo[workflow.currentPhase].description}\n              </div>\n            </div>\n          </div>\n        </div>\n      </header>\n\n      {/* Main Content with Sidebar Layout */}\n      <main className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        <div className=\"flex gap-6\">\n          {/* Main Content Area */}\n          <div className=\"flex-1\">\n        \n        {/* Phase 1: Customer Configuration */}\n        {workflow.currentPhase === 'customer_config' && (\n          <div className=\"max-w-4xl mx-auto\">\n            <div className=\"text-center mb-8\">\n              <h2 className=\"text-3xl font-bold text-gray-900 mb-2\">Select Customer</h2>\n              <p className=\"text-gray-600\">Select customer to start quote process</p>\n            </div>\n            \n            <CustomerSelector\n              customers={customers}\n              contracts={[]}\n              onCustomerSelect={handleCustomerSelect}\n            />\n\n            {workflow.customer && (\n              <div className=\"mt-6 bg-green-50 border border-green-200 rounded-lg p-4\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <h3 className=\"text-lg font-medium text-green-900\">\n                      Customer Selected: {workflow.customer.name}\n                    </h3>\n                    <p className=\"text-sm text-green-700\">\n                      Customer Discount: {workflow.customer.discountPercentage}%\n                    </p>\n                  </div>\n                  <div className=\"flex space-x-3\">\n                    <button\n                      onClick={saveCurrentPhase}\n                      className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm\"\n                    >\n                      Save Customer\n                    </button>\n                    <button\n                      onClick={proceedToNextPhase}\n                      className=\"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md text-sm\"\n                    >\n                      Proceed to Room Setup ‚Üí\n                    </button>\n                  </div>\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n\n        {/* Phase 2: Room Configuration */}\n        {workflow.currentPhase === 'room_config' && (\n          <div className=\"max-w-4xl mx-auto\">\n            <div className=\"text-center mb-8\">\n              <h2 className=\"text-3xl font-bold text-gray-900 mb-2\">Configure Room</h2>\n              <p className=\"text-gray-600\">\n                Customer: <span className=\"font-medium\">{workflow.customer?.name}</span>\n              </p>\n            </div>\n\n            <EnhancedRoomManager\n              models={models}\n              processings={processings}\n              onCreateQuote={handleRoomCreate}\n              existingRooms={workflow.rooms}\n              onAddRoom={handleRoomCreate}\n              onEditRoom={handleRoomEdit}\n              onSelectRoom={handleRoomSelect}\n              currentRoomId={workflow.currentRoomId}\n            />\n\n            <div className=\"mt-6 flex justify-between\">\n              <button\n                onClick={goToPreviousPhase}\n                className=\"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-md\"\n              >\n                ‚Üê Back to Customer\n              </button>\n\n              {workflow.rooms.length > 0 && (\n                <div className=\"flex space-x-3\">\n                  <button\n                    onClick={saveCurrentPhase}\n                    className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md\"\n                  >\n                    Save Room Config\n                  </button>\n                  <button\n                    onClick={proceedToNextPhase}\n                    className=\"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md\"\n                  >\n                    Proceed to Products ‚Üí\n                  </button>\n                </div>\n              )}\n            </div>\n          </div>\n        )}\n\n        {/* Phase 3: Product Configuration */}\n        {workflow.currentPhase === 'product_config' && workflow.rooms.length > 0 && (\n          <div>\n            <div className=\"text-center mb-8\">\n              <h2 className=\"text-3xl font-bold text-gray-900 mb-2\">Configure Products</h2>\n              <p className=\"text-gray-600\">\n                Total Rooms: <span className=\"font-medium\">{workflow.rooms.length}</span>\n              </p>\n            </div>\n\n            {/* Room Selector */}\n            <div className=\"bg-white rounded-lg shadow mb-6 p-4\">\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-3\">Select Room to Configure</h3>\n              <div className=\"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-3\">\n                {workflow.rooms.map((room, index) => {\n                  const roomModel = models.find(m => m.id === room.frontModelId);\n                  const roomProductCount = workflow.products.filter(p => p.roomId === room.id).length;\n                  const isActive = workflow.currentRoomId === room.id;\n                  \n                  return (\n                    <button\n                      key={room.id}\n                      onClick={() => handleRoomSelect(room.id)}\n                      className={`p-4 rounded-lg border-2 text-left transition-all ${\n                        isActive \n                          ? 'border-blue-500 bg-blue-50 shadow-md' \n                          : 'border-gray-200 hover:border-gray-300 hover:bg-gray-50'\n                      }`}\n                    >\n                      <div className=\"flex items-center justify-between mb-2\">\n                        <h4 className={`font-semibold ${isActive ? 'text-blue-900' : 'text-gray-900'}`}>\n                          {room.name}\n                        </h4>\n                        {isActive && (\n                          <span className=\"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full\">\n                            Active\n                          </span>\n                        )}\n                      </div>\n                      {room.description && (\n                        <p className=\"text-sm text-gray-700 mb-2 italic\">\n                          \"{room.description}\"\n                        </p>\n                      )}\n                      <p className=\"text-sm text-gray-600 mb-1\">\n                        Style: {roomModel?.name}\n                      </p>\n                      <p className=\"text-sm text-gray-500\">\n                        Products: {roomProductCount}\n                      </p>\n                    </button>\n                  );\n                })}\n              </div>\n              {!workflow.currentRoomId && (\n                <div className=\"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg\">\n                  <p className=\"text-sm text-yellow-800\">\n                    üëÜ Select a room above to start adding products\n                  </p>\n                </div>\n              )}\n            </div>\n\n            {/* Product Configuration for Selected Room */}\n            {workflow.currentRoomId && (\n              <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n                <div className=\"lg:col-span-2\">\n                  <div className=\"bg-white rounded-lg shadow p-4 mb-4\">\n                    <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">\n                      Adding Products to: <span className=\"text-blue-600\">{getCurrentRoom()?.name}</span>\n                    </h3>\n                    {getCurrentRoom()?.description && (\n                      <p className=\"text-sm text-gray-700 mb-2 italic\">\n                        Room Description: \"{getCurrentRoom()?.description}\"\n                      </p>\n                    )}\n                    <p className=\"text-sm text-gray-600\">\n                      Style: {getCurrentRoomModel()?.name} ‚Ä¢ Products will inherit this room's configuration\n                    </p>\n                  </div>\n                  <CleanProductCatalog\n                    models={models}\n                    products={products}\n                    selectedModel={getCurrentRoomModel()}\n                    onModelSelect={() => {}} // Disabled in improved workflow\n                    onProductSelect={(product, quantity) => handleProductAdd(product.id, quantity)}\n                    hasQuote={true}\n                    onCreateQuote={() => {}}\n                  />\n                </div>\n                \n                <div className=\"space-y-6\">\n                  {/* Current Room Products */}\n                  <div className=\"bg-white rounded-lg shadow p-6\">\n                    <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">\n                      {getCurrentRoom()?.name} Products\n                    </h3>\n                    {(() => {\n                      const currentRoomProducts = workflow.products.filter(p => p.roomId === workflow.currentRoomId);\n                      return currentRoomProducts.length === 0 ? (\n                        <div className=\"text-center py-6 text-gray-500\">\n                          <svg className=\"w-12 h-12 mx-auto mb-3 text-gray-300\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4\" />\n                          </svg>\n                          <p className=\"text-sm\">No products added to this room</p>\n                        </div>\n                      ) : (\n                        <div className=\"space-y-3\">\n                          {currentRoomProducts.map((product) => {\n                            const productDetails = products.find(p => p.id === product.productId);\n                            return (\n                              <div key={product.id} className=\"bg-gray-50 rounded-lg p-3 border border-gray-200\">\n                                <div className=\"flex justify-between items-start mb-2\">\n                                  <div className=\"flex-1\">\n                                    <h4 className=\"text-sm font-medium text-gray-900\">{productDetails?.name}</h4>\n                                    <p className=\"text-xs text-gray-600\">${productDetails?.basePrice.toFixed(2)} each</p>\n                                  </div>\n                                  <button\n                                    onClick={() => removeProduct(product.productId)}\n                                    className=\"text-red-600 hover:text-red-800 text-xs\"\n                                  >\n                                    Remove\n                                  </button>\n                                </div>\n                                \n                                {/* Quantity Controls */}\n                                <div className=\"flex items-center justify-between\">\n                                  <span className=\"text-xs text-gray-600\">Quantity:</span>\n                                  <div className=\"flex items-center space-x-2\">\n                                    <button\n                                      onClick={() => adjustProductQuantity(product.productId, -1)}\n                                      className=\"w-6 h-6 rounded-full bg-gray-200 hover:bg-gray-300 flex items-center justify-center text-gray-600 text-sm\"\n                                    >\n                                      ‚àí\n                                    </button>\n                                    <span className=\"text-sm font-medium w-8 text-center\">{product.quantity}</span>\n                                    <button\n                                      onClick={() => adjustProductQuantity(product.productId, 1)}\n                                      className=\"w-6 h-6 rounded-full bg-blue-600 hover:bg-blue-700 flex items-center justify-center text-white text-sm\"\n                                    >\n                                      +\n                                    </button>\n                                  </div>\n                                </div>\n                                \n                                {/* Total for this product */}\n                                <div className=\"flex justify-between items-center mt-2 pt-2 border-t border-gray-200\">\n                                  <span className=\"text-xs text-gray-600\">Total:</span>\n                                  <span className=\"text-sm font-semibold text-green-600\">\n                                    ${product.totalPrice.toFixed(2)}\n                                  </span>\n                                </div>\n                              </div>\n                            );\n                          })}\n                          \n                          <div className=\"border-t border-gray-200 pt-3 mt-4\">\n                            <div className=\"flex justify-between text-sm\">\n                              <span className=\"text-gray-600\">Room Total:</span>\n                              <span className=\"font-medium text-green-600\">\n                                ${currentRoomProducts.reduce((sum, product) => sum + product.totalPrice, 0).toFixed(2)}\n                              </span>\n                            </div>\n                          </div>\n                        </div>\n                      );\n                    })()}\n                  </div>\n\n                  {/* All Rooms Summary */}\n                  <div className=\"bg-white rounded-lg shadow p-6\">\n                    <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">All Rooms Summary</h3>\n                    <div className=\"space-y-3\">\n                      {workflow.rooms.map((room) => {\n                        const roomProducts = workflow.products.filter(p => p.roomId === room.id);\n                        const roomTotal = roomProducts.reduce((sum, product) => sum + product.totalPrice, 0);\n                        \n                        return (\n                          <div \n                            key={room.id} \n                            className={`p-3 rounded border cursor-pointer transition-colors ${\n                              room.id === workflow.currentRoomId \n                                ? 'border-blue-500 bg-blue-50' \n                                : 'border-gray-200 hover:bg-gray-50'\n                            }`}\n                            onClick={() => handleRoomSelect(room.id)}\n                          >\n                            <div className=\"flex justify-between items-center\">\n                              <div>\n                                <h4 className=\"font-medium text-gray-900\">{room.name}</h4>\n                                <p className=\"text-xs text-gray-600\">{roomProducts.length} products</p>\n                              </div>\n                              <div className=\"text-right\">\n                                <p className=\"text-sm font-semibold text-green-600\">\n                                  ${roomTotal.toFixed(2)}\n                                </p>\n                                {room.id === workflow.currentRoomId && (\n                                  <p className=\"text-xs text-blue-600\">Active</p>\n                                )}\n                              </div>\n                            </div>\n                          </div>\n                        );\n                      })}\n                      \n                      <div className=\"border-t border-gray-200 pt-3 mt-4\">\n                        <div className=\"flex justify-between text-base font-semibold\">\n                          <span className=\"text-gray-900\">Grand Total:</span>\n                          <span className=\"text-green-600\">\n                            ${workflow.products.reduce((sum, product) => sum + product.totalPrice, 0).toFixed(2)}\n                          </span>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            <div className=\"mt-6 flex justify-between\">\n              <button\n                onClick={goToPreviousPhase}\n                className=\"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-md\"\n              >\n                ‚Üê Back to Room Setup\n              </button>\n\n              {workflow.products.length > 0 && (\n                <div className=\"flex space-x-3\">\n                  <button\n                    onClick={saveCurrentPhase}\n                    className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md\"\n                  >\n                    Save Product Config\n                  </button>\n                  <button\n                    onClick={proceedToNextPhase}\n                    className=\"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md\"\n                  >\n                    Proceed to Quote ‚Üí\n                  </button>\n                </div>\n              )}\n            </div>\n          </div>\n        )}\n\n        {/* Phase 4: Quote Finalization */}\n        {workflow.currentPhase === 'quote_finalize' && workflow.quote && (\n          <div>\n            <div className=\"text-center mb-8\">\n              <h2 className=\"text-3xl font-bold text-gray-900 mb-2\">Finalize Quote</h2>\n              <p className=\"text-gray-600\">Review and configure final quote details</p>\n            </div>\n\n            <LiveProcessingProductManager\n              quote={workflow.quote}\n              rooms={workflow.quote.rooms}\n              products={products}\n              processings={processings}\n              processingRules={processingRules}\n              productDependencies={productDependencies}\n              onQuoteUpdate={handleQuoteUpdate}\n            />\n          </div>\n        )}\n          </div>\n\n          {/* Enhanced Room-Aware Product Sidebar - Only for product_config phase */}\n          {workflow.currentPhase === 'product_config' && (\n            <div className=\"w-80 bg-white rounded-lg shadow-lg p-6 h-fit sticky top-8\">\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center\">\n                <svg className=\"w-5 h-5 mr-2 text-blue-600\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                  <path fillRule=\"evenodd\" d=\"M10 2L3 7v11a1 1 0 001 1h3v-8h6v8h3a1 1 0 001-1V7l-7-5z\" clipRule=\"evenodd\" />\n                </svg>\n                Product Management\n              </h3>\n              \n              <div className=\"space-y-4\">\n                {/* Quick Room Switcher */}\n                <div>\n                  <h4 className=\"text-sm font-medium text-gray-700 mb-2\">Quick Room Switch</h4>\n                  <div className=\"grid grid-cols-1 gap-2\">\n                    {workflow.rooms.map((room) => {\n                      const roomProducts = workflow.products.filter(p => p.roomId === room.id);\n                      const isActive = room.id === workflow.currentRoomId;\n                      \n                      return (\n                        <button\n                          key={room.id}\n                          onClick={() => handleRoomSelect(room.id)}\n                          className={`p-2 rounded text-left text-xs transition-colors ${\n                            isActive \n                              ? 'bg-blue-100 border-blue-300 text-blue-900' \n                              : 'bg-gray-50 border-gray-200 text-gray-700 hover:bg-gray-100'\n                          } border`}\n                        >\n                          <div className=\"flex justify-between items-center\">\n                            <span className=\"font-medium\">{room.name}</span>\n                            <span className=\"text-green-600\">{roomProducts.length}</span>\n                          </div>\n                        </button>\n                      );\n                    })}\n                  </div>\n                </div>\n\n                {/* Products by Room */}\n                <div>\n                  <h4 className=\"text-sm font-medium text-gray-700 mb-2\">Products by Room</h4>\n                  {workflow.rooms.map((room) => {\n                    const roomProducts = workflow.products.filter(p => p.roomId === room.id);\n                    const roomTotal = roomProducts.reduce((sum, product) => sum + product.totalPrice, 0);\n                    \n                    return (\n                      <div key={room.id} className=\"mb-3\">\n                        <div \n                          className={`p-2 rounded cursor-pointer transition-colors ${\n                            room.id === workflow.currentRoomId \n                              ? 'bg-blue-50 border-blue-200' \n                              : 'bg-gray-50 border-gray-200 hover:bg-gray-100'\n                          } border`}\n                          onClick={() => handleRoomSelect(room.id)}\n                        >\n                          <div className=\"flex justify-between items-center mb-1\">\n                            <h5 className=\"text-sm font-medium text-gray-900\">{room.name}</h5>\n                            <span className=\"text-xs text-green-600 font-medium\">\n                              ${roomTotal.toFixed(2)}\n                            </span>\n                          </div>\n                          <div className=\"flex justify-between items-center text-xs text-gray-600\">\n                            <span>{roomProducts.length} products</span>\n                            {room.id === workflow.currentRoomId && (\n                              <span className=\"text-blue-600 font-medium\">‚óè Active</span>\n                            )}\n                          </div>\n                        </div>\n                        \n                        {/* Show products if this room is active */}\n                        {room.id === workflow.currentRoomId && roomProducts.length > 0 && (\n                          <div className=\"mt-2 ml-2 space-y-1\">\n                            {roomProducts.slice(0, 3).map((product) => {\n                              const productDetails = products.find(p => p.id === product.productId);\n                              return (\n                                <div key={product.id} className=\"text-xs text-gray-600 flex justify-between\">\n                                  <span className=\"truncate\">{productDetails?.name}</span>\n                                  <span>√ó{product.quantity}</span>\n                                </div>\n                              );\n                            })}\n                            {roomProducts.length > 3 && (\n                              <div className=\"text-xs text-gray-500\">\n                                +{roomProducts.length - 3} more...\n                              </div>\n                            )}\n                          </div>\n                        )}\n                      </div>\n                    );\n                  })}\n                </div>\n\n                {/* Overall Summary */}\n                <div className=\"border-t pt-4\">\n                  <div className=\"space-y-2\">\n                    <div className=\"flex justify-between text-sm\">\n                      <span className=\"text-gray-600\">Total Rooms:</span>\n                      <span className=\"font-medium\">{workflow.rooms.length}</span>\n                    </div>\n                    <div className=\"flex justify-between text-sm\">\n                      <span className=\"text-gray-600\">Total Products:</span>\n                      <span className=\"font-medium\">{workflow.products.length}</span>\n                    </div>\n                    <div className=\"flex justify-between text-sm font-semibold\">\n                      <span className=\"text-gray-900\">Grand Total:</span>\n                      <span className=\"text-green-600\">\n                        ${workflow.products.reduce((sum, product) => sum + product.totalPrice, 0).toFixed(2)}\n                      </span>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Quick Actions */}\n                {workflow.currentRoomId && (\n                  <div className=\"border-t pt-4\">\n                    <h4 className=\"text-sm font-medium text-gray-700 mb-2\">Quick Actions</h4>\n                    <div className=\"space-y-2\">\n                      <button\n                        onClick={() => {\n                          const currentRoomProducts = workflow.products.filter(p => p.roomId === workflow.currentRoomId);\n                          if (currentRoomProducts.length === 0) {\n                            alert('No products to clear in this room');\n                            return;\n                          }\n                          if (confirm(`Clear all ${currentRoomProducts.length} products from ${getCurrentRoom()?.name}?`)) {\n                            setWorkflow(prev => ({\n                              ...prev,\n                              products: prev.products.filter(p => p.roomId !== workflow.currentRoomId)\n                            }));\n                          }\n                        }}\n                        className=\"w-full text-xs bg-red-50 text-red-700 border border-red-200 rounded px-2 py-1 hover:bg-red-100\"\n                      >\n                        Clear Room Products\n                      </button>\n                    </div>\n                  </div>\n                )}\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Sticky Navigation Bar */}\n        <div className=\"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg z-50\">\n          <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n            <div className=\"flex justify-between items-center py-4\">\n              <div className=\"flex items-center space-x-4\">\n                <span className=\"text-sm text-gray-600\">\n                  Phase {(['customer_config', 'room_config', 'product_config', 'quote_finalize'] as WorkflowPhase[]).indexOf(workflow.currentPhase) + 1} of 4\n                </span>\n                <div className=\"w-32 bg-gray-200 rounded-full h-2\">\n                  <div \n                    className=\"bg-blue-600 h-2 rounded-full transition-all duration-300\"\n                    style={{ width: `${(((['customer_config', 'room_config', 'product_config', 'quote_finalize'] as WorkflowPhase[]).indexOf(workflow.currentPhase) + 1) / 4) * 100}%` }}\n                  ></div>\n                </div>\n              </div>\n\n              <div className=\"flex space-x-3\">\n                <button\n                  onClick={handleReturnToDashboard}\n                  className=\"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-md text-sm flex items-center\"\n                >\n                  üè† Main\n                </button>\n\n                {/* Save Draft - available from any phase with customer selected */}\n                {workflow.customer && (\n                  <button\n                    onClick={handleSaveQuote}\n                    className=\"bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-md text-sm flex items-center\"\n                  >\n                    üíæ Save Draft\n                  </button>\n                )}\n\n                {workflow.currentPhase !== 'customer_config' && (\n                  <button\n                    onClick={goToPreviousPhase}\n                    className=\"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-md text-sm flex items-center\"\n                  >\n                    ‚Üê Back\n                  </button>\n                )}\n                \n                {canProceedToNextPhase() && workflow.currentPhase !== 'quote_finalize' && (\n                  <button\n                    onClick={proceedToNextPhase}\n                    className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm flex items-center\"\n                  >\n                    Continue ‚Üí\n                  </button>\n                )}\n\n                {workflow.currentPhase === 'quote_finalize' && workflow.quote && (\n                  <div className=\"flex space-x-2\">\n                    <button\n                      onClick={handleSaveQuote}\n                      className=\"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md text-sm\"\n                    >\n                      Save & Return\n                    </button>\n                    <button\n                      onClick={() => {\n                        // Show preview in new window\n                        const previewWindow = window.open('', '_blank');\n                        if (previewWindow) {\n                          previewWindow.document.write(generateEnhancedPrintHTML());\n                          previewWindow.document.close();\n                        }\n                      }}\n                      className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm\"\n                    >\n                      Preview Print\n                    </button>\n                    <button\n                      onClick={printQuote}\n                      className=\"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-md text-sm\"\n                    >\n                      Print\n                    </button>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      </main>\n    </div>\n  );\n}\n\nexport default ImprovedApp;\n"],"mappings":"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AAK,CAACuB,EAAE;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+CvB,KAAK,CAACkH,WAAW,IAAIlH,KAAK,CAACuB,EAAE;AAC5E,4CAA4C,IAAIC,IAAI,CAAC,CAAC,CAAC2F,kBAAkB,CAAC,CAAC;AAC3E,mDAAmD,IAAI3F,IAAI,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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}