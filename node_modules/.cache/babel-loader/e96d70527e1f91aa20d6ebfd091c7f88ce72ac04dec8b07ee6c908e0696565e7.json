{"ast":null,"code":"var _jsxFileName = \"/Users/dkjesuschua/Documents/demo_cpq/src/components/SimplifiedQuoteBuilder.tsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useState } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SimplifiedQuoteBuilder = ({\n  quote,\n  rooms,\n  products,\n  processings,\n  processingRules,\n  productDependencies,\n  onQuoteUpdate\n}) => {\n  _s();\n  var _getRoom;\n  const [selectedRoomFilter, setSelectedRoomFilter] = useState('all');\n  const [orderDiscount, setOrderDiscount] = useState(quote.orderDiscount);\n  const [optionSelector, setOptionSelector] = useState({\n    isOpen: false,\n    itemId: '',\n    processingId: '',\n    processing: null,\n    currentValues: []\n  });\n  const getProduct = productId => products.find(p => p.id === productId);\n  const getProcessing = processingId => processings.find(p => p.id === processingId);\n  const getRoom = roomId => rooms.find(r => r.id === roomId);\n  const filteredItems = selectedRoomFilter === 'all' ? quote.items : quote.items.filter(item => item.roomId === selectedRoomFilter);\n  const updateQuantity = (itemId, newQuantity) => {\n    const updatedItems = quote.items.map(item => {\n      if (item.id === itemId) {\n        const updatedItem = {\n          ...item,\n          quantity: newQuantity\n        };\n        updatedItem.totalPrice = updatedItem.basePrice * newQuantity + updatedItem.appliedProcessings.reduce((sum, ap) => sum + ap.calculatedPrice, 0);\n        return updatedItem;\n      }\n      return item;\n    });\n    recalculateQuote({\n      ...quote,\n      items: updatedItems\n    });\n  };\n  const removeItem = itemId => {\n    const updatedItems = quote.items.filter(item => item.id !== itemId);\n    recalculateQuote({\n      ...quote,\n      items: updatedItems\n    });\n  };\n  const getAvailableProcessings = (productId, currentProcessings) => {\n    const product = getProduct(productId);\n    if (!product) return [];\n\n    // Get processings applicable to this product category\n    let available = processings.filter(proc => proc.applicableProductCategories.includes(product.category));\n\n    // Apply mutual exclusion rules\n    const mutualExclusionRules = processingRules.filter(rule => rule.type === 'mutual_exclusion');\n    mutualExclusionRules.forEach(rule => {\n      const hasConflicting = currentProcessings.some(procId => {\n        var _rule$conditions$proc;\n        return (_rule$conditions$proc = rule.conditions.processingIds) === null || _rule$conditions$proc === void 0 ? void 0 : _rule$conditions$proc.includes(procId);\n      });\n      if (hasConflicting && rule.actions.excludeProcessings) {\n        available = available.filter(proc => {\n          var _rule$actions$exclude;\n          return !((_rule$actions$exclude = rule.actions.excludeProcessings) !== null && _rule$actions$exclude !== void 0 && _rule$actions$exclude.includes(proc.id));\n        });\n      }\n    });\n\n    // Remove already applied processings\n    available = available.filter(proc => !currentProcessings.includes(proc.id));\n    return available;\n  };\n  const addProcessingToItem = (itemId, processingId, optionValues) => {\n    var _processing$options;\n    console.log('ðŸ”§ addProcessingToItem called:', {\n      itemId,\n      processingId,\n      optionValues\n    });\n    const item = quote.items.find(i => i.id === itemId);\n    const processing = getProcessing(processingId);\n    const product = item ? getProduct(item.productId) : null;\n    console.log('ðŸ”§ Found:', {\n      item: !!item,\n      processing: !!processing,\n      product: !!product\n    });\n    console.log('ðŸ”§ Processing details:', processing ? {\n      id: processing.id,\n      name: processing.name,\n      requiresOptions: processing.requiresOptions,\n      hasOptions: !!processing.options,\n      optionsCount: ((_processing$options = processing.options) === null || _processing$options === void 0 ? void 0 : _processing$options.length) || 0\n    } : 'null');\n    if (!item || !processing || !product) {\n      console.log('âŒ Missing required data, returning early');\n      return;\n    }\n\n    // If processing requires options but no option values provided, open option selector\n    if (processing.requiresOptions && (!optionValues || optionValues.length === 0)) {\n      console.log('ðŸ”§ Processing requires options, opening option selector...');\n      openOptionSelector(itemId, processingId);\n      return;\n    }\n\n    // Calculate processing price including option modifiers\n    let calculatedPrice = 0;\n    let optionPriceModifier = 0;\n    if (optionValues) {\n      optionPriceModifier = optionValues.reduce((sum, ov) => sum + (ov.priceModifier || 0), 0);\n    }\n    if (processing.pricingType === 'per_unit') {\n      calculatedPrice = (processing.price + optionPriceModifier) * item.quantity;\n    } else if (processing.pricingType === 'percentage') {\n      calculatedPrice = item.basePrice * item.quantity * processing.price;\n      if (optionPriceModifier > 0) {\n        calculatedPrice += optionPriceModifier * item.quantity;\n      }\n    } else if (processing.pricingType === 'per_dimension' && product.dimensions) {\n      calculatedPrice = (product.dimensions.width || 0) * processing.price;\n      if (optionPriceModifier > 0) {\n        calculatedPrice += optionPriceModifier;\n      }\n    }\n    const updatedItems = quote.items.map(i => {\n      if (i.id === itemId) {\n        const updatedItem = {\n          ...i,\n          appliedProcessings: [...i.appliedProcessings, {\n            processingId,\n            calculatedPrice,\n            optionValues: optionValues || [],\n            requiresOptions: false // Options are now provided\n          }]\n        };\n        updatedItem.totalPrice = updatedItem.basePrice * updatedItem.quantity + updatedItem.appliedProcessings.reduce((sum, ap) => sum + ap.calculatedPrice, 0);\n        return updatedItem;\n      }\n      return i;\n    });\n    recalculateQuote({\n      ...quote,\n      items: updatedItems\n    });\n  };\n  const removeProcessingFromItem = (itemId, processingId) => {\n    const updatedItems = quote.items.map(item => {\n      if (item.id === itemId) {\n        const updatedItem = {\n          ...item,\n          appliedProcessings: item.appliedProcessings.filter(ap => ap.processingId !== processingId)\n        };\n        updatedItem.totalPrice = updatedItem.basePrice * updatedItem.quantity + updatedItem.appliedProcessings.reduce((sum, ap) => sum + ap.calculatedPrice, 0);\n        return updatedItem;\n      }\n      return item;\n    });\n    recalculateQuote({\n      ...quote,\n      items: updatedItems\n    });\n  };\n  const updateProcessingOptions = (itemId, processingId, optionValues) => {\n    const item = quote.items.find(i => i.id === itemId);\n    const processing = getProcessing(processingId);\n    const product = item ? getProduct(item.productId) : null;\n    if (!item || !processing || !product) return;\n\n    // Recalculate price with new option values\n    let calculatedPrice = 0;\n    let optionPriceModifier = optionValues.reduce((sum, ov) => sum + (ov.priceModifier || 0), 0);\n    if (processing.pricingType === 'per_unit') {\n      calculatedPrice = (processing.price + optionPriceModifier) * item.quantity;\n    } else if (processing.pricingType === 'percentage') {\n      calculatedPrice = item.basePrice * item.quantity * processing.price;\n      if (optionPriceModifier > 0) {\n        calculatedPrice += optionPriceModifier * item.quantity;\n      }\n    } else if (processing.pricingType === 'per_dimension' && product.dimensions) {\n      calculatedPrice = (product.dimensions.width || 0) * processing.price;\n      if (optionPriceModifier > 0) {\n        calculatedPrice += optionPriceModifier;\n      }\n    }\n    const updatedItems = quote.items.map(i => {\n      if (i.id === itemId) {\n        const updatedItem = {\n          ...i,\n          appliedProcessings: i.appliedProcessings.map(ap => ap.processingId === processingId ? {\n            ...ap,\n            optionValues,\n            calculatedPrice,\n            requiresOptions: false // Options are now provided\n          } : ap)\n        };\n        updatedItem.totalPrice = updatedItem.basePrice * updatedItem.quantity + updatedItem.appliedProcessings.reduce((sum, ap) => sum + ap.calculatedPrice, 0);\n        return updatedItem;\n      }\n      return i;\n    });\n    recalculateQuote({\n      ...quote,\n      items: updatedItems\n    });\n  };\n\n  // Check if there are any pending processing options that need resolution\n  const getPendingProcessingOptions = () => {\n    const pendingOptions = [];\n    quote.items.forEach(item => {\n      item.appliedProcessings.forEach(ap => {\n        if (ap.requiresOptions) {\n          const processing = getProcessing(ap.processingId);\n          if (processing && processing.options) {\n            const requiredOptions = processing.options.filter(opt => opt.required).map(opt => opt.id);\n            if (requiredOptions.length > 0) {\n              pendingOptions.push({\n                itemId: item.id,\n                processingId: ap.processingId,\n                processingName: processing.name,\n                requiredOptions\n              });\n            }\n          }\n        }\n      });\n    });\n    return pendingOptions;\n  };\n  const openOptionSelector = (itemId, processingId) => {\n    console.log('ðŸ”§ openOptionSelector called:', {\n      itemId,\n      processingId\n    });\n    const processing = getProcessing(processingId);\n    console.log('ðŸ”§ Processing found:', processing ? {\n      id: processing.id,\n      name: processing.name,\n      requiresOptions: processing.requiresOptions,\n      hasOptions: !!processing.options\n    } : 'null');\n    if (!processing || !processing.requiresOptions) {\n      console.log('âŒ Processing not found or does not require options, returning early');\n      return;\n    }\n    console.log('ðŸ”§ Opening option selector modal...');\n    setOptionSelector({\n      isOpen: true,\n      itemId,\n      processingId,\n      processing,\n      currentValues: []\n    });\n    console.log('âœ… Option selector state updated');\n  };\n  const closeOptionSelector = () => {\n    setOptionSelector({\n      isOpen: false,\n      itemId: '',\n      processingId: '',\n      processing: null,\n      currentValues: []\n    });\n  };\n  const handleOptionValuesChange = values => {\n    setOptionSelector(prev => ({\n      ...prev,\n      currentValues: values\n    }));\n  };\n  const handleApplyOptions = () => {\n    if (optionSelector.processing && optionSelector.currentValues.length > 0) {\n      addProcessingToItem(optionSelector.itemId, optionSelector.processingId, optionSelector.currentValues);\n    } else if (optionSelector.processing) {\n      // If no options but processing requires them, add with empty values to flag as requiring options\n      addProcessingToItem(optionSelector.itemId, optionSelector.processingId, []);\n    }\n    closeOptionSelector();\n  };\n  const applyOrderDiscount = () => {\n    const updatedQuote = {\n      ...quote,\n      orderDiscount\n    };\n    recalculateQuote(updatedQuote);\n  };\n  const recalculateQuote = updatedQuote => {\n    const subtotal = updatedQuote.items.reduce((sum, item) => sum + item.totalPrice, 0);\n    const customerDiscount = subtotal * (updatedQuote.customerDiscount / 100);\n    const totalDiscount = customerDiscount + updatedQuote.orderDiscount;\n    const finalTotal = subtotal - totalDiscount;\n    const finalQuote = {\n      ...updatedQuote,\n      subtotal,\n      totalDiscount,\n      finalTotal,\n      requiresApproval: finalTotal > updatedQuote.approvalThreshold\n    };\n    onQuoteUpdate(finalQuote);\n  };\n\n  // Group items by room for better organization\n  const itemsByRoom = quote.items.reduce((acc, item) => {\n    const roomId = item.roomId;\n    if (!acc[roomId]) acc[roomId] = [];\n    acc[roomId].push(item);\n    return acc;\n  }, {});\n  const pendingOptions = getPendingProcessingOptions();\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"space-y-6\",\n    children: [pendingOptions.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-yellow-50 border border-yellow-200 rounded-lg p-4\",\n      \"data-testid\": \"pending-options-alert\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-start\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-shrink-0\",\n          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n            className: \"h-5 w-5 text-yellow-400\",\n            viewBox: \"0 0 20 20\",\n            fill: \"currentColor\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              fillRule: \"evenodd\",\n              d: \"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z\",\n              clipRule: \"evenodd\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 359,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 358,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 357,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ml-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-sm font-medium text-yellow-800\",\n            children: \"Processing Options Required\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 363,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mt-2 text-sm text-yellow-700\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"The following processings require additional options to be specified:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 367,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n              className: \"mt-2 list-disc list-inside space-y-1\",\n              children: pendingOptions.map((option, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: option.processingName\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 371,\n                  columnNumber: 23\n                }, this), \" - Missing: \", option.requiredOptions.join(', ')]\n              }, index, true, {\n                fileName: _jsxFileName,\n                lineNumber: 370,\n                columnNumber: 21\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 368,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 366,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 362,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 356,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 355,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white rounded-lg shadow p-4\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center justify-between\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-medium text-gray-900\",\n          children: \"Filter by Room\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 384,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          value: selectedRoomFilter,\n          onChange: e => setSelectedRoomFilter(e.target.value),\n          className: \"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\",\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"all\",\n            children: [\"All Rooms (\", quote.items.length, \" items)\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 390,\n            columnNumber: 13\n          }, this), rooms.map(room => {\n            const roomItems = quote.items.filter(item => item.roomId === room.id);\n            return /*#__PURE__*/_jsxDEV(\"option\", {\n              value: room.id,\n              children: [room.name, \" (\", roomItems.length, \" items)\"]\n            }, room.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 394,\n              columnNumber: 17\n            }, this);\n          })]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 385,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 383,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 382,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-6\",\n      children: selectedRoomFilter === 'all' ?\n      // Show all rooms\n      rooms.map(room => {\n        const roomItems = itemsByRoom[room.id] || [];\n        if (roomItems.length === 0) return null;\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-white rounded-lg shadow\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-4 border-b border-gray-200 bg-blue-50\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"text-lg font-medium text-gray-900\",\n              children: room.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 414,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm text-gray-600\",\n              children: [roomItems.length, \" items\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 415,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 413,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"divide-y divide-gray-200\",\n            children: roomItems.map(item => /*#__PURE__*/_jsxDEV(ItemRow, {\n              item: item,\n              product: getProduct(item.productId),\n              getProcessing: getProcessing,\n              getAvailableProcessings: getAvailableProcessings,\n              updateQuantity: updateQuantity,\n              removeItem: removeItem,\n              addProcessingToItem: addProcessingToItem,\n              removeProcessingFromItem: removeProcessingFromItem,\n              updateProcessingOptions: updateProcessingOptions,\n              openOptionSelector: openOptionSelector\n            }, item.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 419,\n              columnNumber: 21\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 417,\n            columnNumber: 17\n          }, this)]\n        }, room.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 412,\n          columnNumber: 15\n        }, this);\n      }) :\n      /*#__PURE__*/\n      // Show single room\n      _jsxDEV(\"div\", {\n        className: \"bg-white rounded-lg shadow\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-4 border-b border-gray-200\",\n          children: /*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-lg font-medium text-gray-900\",\n            children: [((_getRoom = getRoom(selectedRoomFilter)) === null || _getRoom === void 0 ? void 0 : _getRoom.name) || 'Room', \" Items\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 441,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 440,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"divide-y divide-gray-200\",\n          children: filteredItems.map(item => /*#__PURE__*/_jsxDEV(ItemRow, {\n            item: item,\n            product: getProduct(item.productId),\n            getProcessing: getProcessing,\n            getAvailableProcessings: getAvailableProcessings,\n            updateQuantity: updateQuantity,\n            removeItem: removeItem,\n            addProcessingToItem: addProcessingToItem,\n            removeProcessingFromItem: removeProcessingFromItem,\n            updateProcessingOptions: updateProcessingOptions,\n            openOptionSelector: openOptionSelector\n          }, item.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 447,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 445,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 439,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 404,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white rounded-lg shadow p-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"text-lg font-medium text-gray-900 mb-4\",\n        children: \"Quote Summary\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 468,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-between\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-gray-600\",\n            children: \"Subtotal:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 472,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"font-medium\",\n            children: [\"$\", quote.subtotal.toFixed(2)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 473,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 471,\n          columnNumber: 11\n        }, this), quote.customerDiscount > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-between\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-gray-600\",\n            children: [\"Customer Discount (\", quote.customerDiscount, \"%):\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 478,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-red-600\",\n            children: [\"-$\", (quote.subtotal * quote.customerDiscount / 100).toFixed(2)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 479,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 477,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-between items-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-gray-600\",\n            children: \"Order Discount:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 484,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center space-x-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"number\",\n              min: \"0\",\n              step: \"0.01\",\n              value: orderDiscount,\n              onChange: e => setOrderDiscount(parseFloat(e.target.value) || 0),\n              className: \"w-24 px-2 py-1 border border-gray-300 rounded text-right\",\n              placeholder: \"0.00\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 486,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: applyOrderDiscount,\n              className: \"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700\",\n              children: \"Apply\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 495,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 485,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 483,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"pt-3 border-t border-gray-200\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-between items-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-lg font-semibold text-gray-900\",\n              children: \"Final Total:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 506,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-xl font-bold text-green-600\",\n              children: [\"$\", quote.finalTotal.toFixed(2)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 507,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 505,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 504,\n          columnNumber: 11\n        }, this), quote.requiresApproval && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded\",\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-sm text-yellow-800\",\n            children: [\"\\u26A0\\uFE0F This quote requires approval as it exceeds $\", quote.approvalThreshold.toLocaleString()]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 513,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 512,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 470,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 467,\n      columnNumber: 7\n    }, this), optionSelector.isOpen && optionSelector.processing && /*#__PURE__*/_jsxDEV(ProcessingOptionSelector, {\n      processing: optionSelector.processing,\n      currentValues: optionSelector.currentValues,\n      onValuesChange: handleOptionValuesChange,\n      onApply: handleApplyOptions,\n      onCancel: closeOptionSelector\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 523,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 352,\n    columnNumber: 5\n  }, this);\n};\n\n// Extracted ItemRow component for cleaner code\n_s(SimplifiedQuoteBuilder, \"YY1Fl9iOHPFJR092biXBAwFALcU=\");\n_c = SimplifiedQuoteBuilder;\nconst ItemRow = ({\n  item,\n  product,\n  getProcessing,\n  getAvailableProcessings,\n  updateQuantity,\n  removeItem,\n  addProcessingToItem,\n  removeProcessingFromItem,\n  updateProcessingOptions,\n  openOptionSelector\n}) => {\n  if (!product) return null;\n  const currentProcessingIds = item.appliedProcessings.map(ap => ap.processingId);\n  const availableProcessings = getAvailableProcessings(item.productId, currentProcessingIds);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"p-6\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex justify-between items-start mb-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex-1\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          className: \"text-lg font-medium text-gray-900\",\n          children: product.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 568,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-gray-600\",\n          children: product.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 569,\n          columnNumber: 11\n        }, this), product.dimensions && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-xs text-gray-500 mt-1\",\n          children: [product.dimensions.width, \"\\\"W \\xD7 \", product.dimensions.height, \"\\\"H \\xD7 \", product.dimensions.depth, \"\\\"D\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 571,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 567,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center space-x-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"text-sm text-gray-600\",\n            children: \"Qty:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 579,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"number\",\n            min: \"1\",\n            value: item.quantity,\n            onChange: e => updateQuantity(item.id, parseInt(e.target.value) || 1),\n            className: \"w-16 px-2 py-1 border border-gray-300 rounded text-center\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 580,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 578,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-right\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-lg font-semibold text-gray-900\",\n            children: [\"$\", item.totalPrice.toFixed(2)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 590,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-xs text-gray-500\",\n            children: [\"Base: $\", (item.basePrice * item.quantity).toFixed(2)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 593,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 589,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => removeItem(item.id),\n          className: \"text-red-600 hover:text-red-800 p-1\",\n          title: \"Remove item\",\n          children: \"\\u2715\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 598,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 577,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 566,\n      columnNumber: 7\n    }, this), item.appliedProcessings.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n        className: \"text-sm font-medium text-gray-700 mb-2\",\n        children: \"Applied Processings:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 611,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-2\",\n        children: item.appliedProcessings.map(ap => {\n          const processing = getProcessing(ap.processingId);\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `px-3 py-2 rounded ${ap.requiresOptions ? 'bg-yellow-50 border border-yellow-200' : 'bg-blue-50'}`,\n            \"data-testid\": \"applied-processing\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex justify-between items-start\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex-1\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center space-x-2\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-sm font-medium text-blue-900\",\n                    children: processing === null || processing === void 0 ? void 0 : processing.name\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 620,\n                    columnNumber: 25\n                  }, this), ap.requiresOptions && /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-yellow-100 text-yellow-800\",\n                    children: \"Options Required\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 622,\n                    columnNumber: 27\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 619,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-xs text-blue-700\",\n                  children: processing === null || processing === void 0 ? void 0 : processing.description\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 627,\n                  columnNumber: 23\n                }, this), ap.optionValues && ap.optionValues.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"mt-2 text-xs text-gray-600\",\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Options:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 632,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n                    className: \"ml-2 mt-1 space-y-1\",\n                    children: ap.optionValues.map((ov, index) => {\n                      var _processing$options2;\n                      const option = processing === null || processing === void 0 ? void 0 : (_processing$options2 = processing.options) === null || _processing$options2 === void 0 ? void 0 : _processing$options2.find(opt => opt.id === ov.optionId);\n                      return /*#__PURE__*/_jsxDEV(\"li\", {\n                        children: [option === null || option === void 0 ? void 0 : option.name, \": \", ov.value, ov.priceModifier && ov.priceModifier > 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"text-green-600 ml-1\",\n                          children: [\"(+$\", ov.priceModifier, \")\"]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 640,\n                          columnNumber: 37\n                        }, this)]\n                      }, index, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 637,\n                        columnNumber: 33\n                      }, this);\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 633,\n                    columnNumber: 27\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 631,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 618,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center space-x-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-sm font-medium text-blue-900\",\n                  children: [\"+$\", ap.calculatedPrice.toFixed(2)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 651,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => removeProcessingFromItem(item.id, ap.processingId),\n                  className: \"text-red-600 hover:text-red-800 text-xs\",\n                  children: \"Remove\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 654,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 650,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 617,\n              columnNumber: 19\n            }, this)\n          }, ap.processingId, false, {\n            fileName: _jsxFileName,\n            lineNumber: 616,\n            columnNumber: 17\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 612,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 610,\n      columnNumber: 9\n    }, this), availableProcessings.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n        className: \"text-sm font-medium text-gray-700 mb-2\",\n        children: \"Available Processings:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 672,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3\",\n        \"data-testid\": \"available-processings\",\n        children: availableProcessings.map(processing => /*#__PURE__*/_jsxDEV(\"button\", {\n          \"data-testid\": \"processing-item\",\n          onClick: () => addProcessingToItem(item.id, processing.id),\n          className: \"text-left p-3 border border-gray-200 rounded hover:border-blue-300 hover:bg-blue-50 transition-colors\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-between items-start\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n                className: \"text-sm font-medium text-gray-900\",\n                children: processing.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 683,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-xs text-gray-600\",\n                children: processing.description\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 684,\n                columnNumber: 21\n              }, this), processing.requiresOptions && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-orange-100 text-orange-800 mt-1\",\n                children: \"Requires Options\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 686,\n                columnNumber: 23\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 682,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-right\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-sm font-medium text-green-600\",\n                children: processing.pricingType === 'percentage' ? `${(processing.price * 100).toFixed(0)}%` : `$${processing.price.toFixed(2)}`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 692,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-xs text-gray-500\",\n                children: processing.pricingType.replace('_', ' ')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 698,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 691,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 681,\n            columnNumber: 17\n          }, this)\n        }, processing.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 675,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 673,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 671,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 565,\n    columnNumber: 5\n  }, this);\n};\n\n// ProcessingOptionSelector component for handling processing options\n_c2 = ItemRow;\nconst ProcessingOptionSelector = ({\n  processing,\n  currentValues,\n  onValuesChange,\n  onApply,\n  onCancel\n}) => {\n  _s2();\n  var _processing$options3;\n  const [values, setValues] = useState(currentValues);\n  const handleOptionChange = (optionId, value, priceModifier) => {\n    const newValues = values.filter(v => v.optionId !== optionId);\n    if (value !== undefined && value !== '') {\n      newValues.push({\n        optionId,\n        value,\n        priceModifier\n      });\n    }\n    setValues(newValues);\n    onValuesChange(newValues);\n  };\n  const getCurrentValue = optionId => {\n    var _values$find;\n    const value = (_values$find = values.find(v => v.optionId === optionId)) === null || _values$find === void 0 ? void 0 : _values$find.value;\n    if (value === undefined || value === null) return '';\n    return String(value);\n  };\n  const renderOptionInput = option => {\n    var _option$validation, _option$validation2, _option$choices2, _values$find2;\n    const currentValue = getCurrentValue(option.id);\n    switch (option.type) {\n      case 'text':\n        return /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          value: currentValue,\n          onChange: e => handleOptionChange(option.id, e.target.value),\n          className: \"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\",\n          placeholder: option.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 741,\n          columnNumber: 11\n        }, this);\n      case 'number':\n        return /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"number\",\n          value: currentValue,\n          onChange: e => handleOptionChange(option.id, parseFloat(e.target.value) || 0),\n          min: (_option$validation = option.validation) === null || _option$validation === void 0 ? void 0 : _option$validation.min,\n          max: (_option$validation2 = option.validation) === null || _option$validation2 === void 0 ? void 0 : _option$validation2.max,\n          className: \"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\",\n          placeholder: option.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 752,\n          columnNumber: 11\n        }, this);\n      case 'select':\n        return /*#__PURE__*/_jsxDEV(\"select\", {\n          value: currentValue,\n          onChange: e => {\n            var _option$choices;\n            const choice = (_option$choices = option.choices) === null || _option$choices === void 0 ? void 0 : _option$choices.find(c => c.value === e.target.value);\n            handleOptionChange(option.id, e.target.value, choice === null || choice === void 0 ? void 0 : choice.priceModifier);\n          },\n          className: \"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\",\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"\",\n            children: [\"Select \", option.name]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 773,\n            columnNumber: 13\n          }, this), (_option$choices2 = option.choices) === null || _option$choices2 === void 0 ? void 0 : _option$choices2.map((choice, index) => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: choice.value,\n            children: [choice.label, \" \", choice.priceModifier && choice.priceModifier > 0 ? `(+$${choice.priceModifier})` : '']\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 775,\n            columnNumber: 15\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 765,\n          columnNumber: 11\n        }, this);\n      case 'boolean':\n        const booleanValue = ((_values$find2 = values.find(v => v.optionId === option.id)) === null || _values$find2 === void 0 ? void 0 : _values$find2.value) === true;\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            checked: booleanValue,\n            onChange: e => handleOptionChange(option.id, e.target.checked),\n            className: \"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 786,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"ml-2 text-sm text-gray-700\",\n            children: option.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 792,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 785,\n          columnNumber: 11\n        }, this);\n      default:\n        return null;\n    }\n  };\n  const isFormValid = () => {\n    if (!processing.options) return true;\n    return processing.options.every(option => !option.required || getCurrentValue(option.id) !== '');\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",\n    \"data-testid\": \"option-selector-modal\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 max-h-96 overflow-y-auto\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-medium text-gray-900 mb-4\",\n          children: [\"Configure \", processing.name]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 812,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-4\",\n          children: (_processing$options3 = processing.options) === null || _processing$options3 === void 0 ? void 0 : _processing$options3.map(option => /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-medium text-gray-700 mb-1\",\n              children: [option.name, option.required && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-red-500 ml-1\",\n                children: \"*\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 821,\n                columnNumber: 39\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 819,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              \"data-testid\": \"option-input\",\n              children: renderOptionInput(option)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 823,\n              columnNumber: 17\n            }, this), option.validation && /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-xs text-gray-500 mt-1\",\n              children: [option.validation.min !== undefined && `Min: ${option.validation.min}`, option.validation.max !== undefined && ` Max: ${option.validation.max}`]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 827,\n              columnNumber: 19\n            }, this)]\n          }, option.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 818,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 816,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-end space-x-3 mt-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: onCancel,\n            \"data-testid\": \"cancel-options-button\",\n            className: \"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500\",\n            children: \"Cancel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 837,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: onApply,\n            \"data-testid\": \"apply-options-button\",\n            disabled: !isFormValid(),\n            className: \"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\",\n            children: \"Apply\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 844,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 836,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 811,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 810,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 809,\n    columnNumber: 5\n  }, this);\n};\n_s2(ProcessingOptionSelector, \"uOy8+MZsXIcRHJPC+fR7Ko4Tzd8=\");\n_c3 = ProcessingOptionSelector;\nexport default SimplifiedQuoteBuilder;\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"SimplifiedQuoteBuilder\");\n$RefreshReg$(_c2, \"ItemRow\");\n$RefreshReg$(_c3, \"ProcessingOptionSelector\");","map":{"version":3,"names":["React","useState","jsxDEV","_jsxDEV","SimplifiedQuoteBuilder","quote","rooms","products","processings","processingRules","productDependencies","onQuoteUpdate","_s","_getRoom","selectedRoomFilter","setSelectedRoomFilter","orderDiscount","setOrderDiscount","optionSelector","setOptionSelector","isOpen","itemId","processingId","processing","currentValues","getProduct","productId","find","p","id","getProcessing","getRoom","roomId","r","filteredItems","items","filter","item","updateQuantity","newQuantity","updatedItems","map","updatedItem","quantity","totalPrice","basePrice","appliedProcessings","reduce","sum","ap","calculatedPrice","recalculateQuote","removeItem","getAvailableProcessings","currentProcessings","product","available","proc","applicableProductCategories","includes","category","mutualExclusionRules","rule","type","forEach","hasConflicting","some","procId","_rule$conditions$proc","conditions","processingIds","actions","excludeProcessings","_rule$actions$exclude","addProcessingToItem","optionValues","_processing$options","console","log","i","name","requiresOptions","hasOptions","options","optionsCount","length","openOptionSelector","optionPriceModifier","ov","priceModifier","pricingType","price","dimensions","width","removeProcessingFromItem","updateProcessingOptions","getPendingProcessingOptions","pendingOptions","requiredOptions","opt","required","push","processingName","closeOptionSelector","handleOptionValuesChange","values","prev","handleApplyOptions","applyOrderDiscount","updatedQuote","subtotal","customerDiscount","totalDiscount","finalTotal","finalQuote","requiresApproval","approvalThreshold","itemsByRoom","acc","className","children","viewBox","fill","fillRule","d","clipRule","fileName","_jsxFileName","lineNumber","columnNumber","option","index","join","value","onChange","e","target","room","roomItems","ItemRow","toFixed","min","step","parseFloat","placeholder","onClick","toLocaleString","ProcessingOptionSelector","onValuesChange","onApply","onCancel","_c","currentProcessingIds","availableProcessings","description","height","depth","parseInt","title","_processing$options2","optionId","replace","_c2","_s2","_processing$options3","setValues","handleOptionChange","newValues","v","undefined","getCurrentValue","_values$find","String","renderOptionInput","_option$validation","_option$validation2","_option$choices2","_values$find2","currentValue","validation","max","_option$choices","choice","choices","c","label","booleanValue","checked","isFormValid","every","disabled","_c3","$RefreshReg$"],"sources":["/Users/dkjesuschua/Documents/demo_cpq/src/components/SimplifiedQuoteBuilder.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { Quote, Product, Processing, ProcessingRule, ProductDependency, Room, ProcessingOptionValue, ProcessingOption } from '../types';\n\ninterface SimplifiedQuoteBuilderProps {\n  quote: Quote;\n  rooms: Room[];\n  products: Product[];\n  processings: Processing[];\n  processingRules: ProcessingRule[];\n  productDependencies: ProductDependency[];\n  onQuoteUpdate: (quote: Quote) => void;\n}\n\nconst SimplifiedQuoteBuilder: React.FC<SimplifiedQuoteBuilderProps> = ({\n  quote,\n  rooms,\n  products,\n  processings,\n  processingRules,\n  productDependencies,\n  onQuoteUpdate\n}) => {\n  const [selectedRoomFilter, setSelectedRoomFilter] = useState<string>('all');\n  const [orderDiscount, setOrderDiscount] = useState(quote.orderDiscount);\n  const [optionSelector, setOptionSelector] = useState<{\n    isOpen: boolean;\n    itemId: string;\n    processingId: string;\n    processing: Processing | null;\n    currentValues: ProcessingOptionValue[];\n  }>({\n    isOpen: false,\n    itemId: '',\n    processingId: '',\n    processing: null,\n    currentValues: []\n  });\n\n  const getProduct = (productId: string) => products.find(p => p.id === productId);\n  const getProcessing = (processingId: string) => processings.find(p => p.id === processingId);\n  const getRoom = (roomId: string) => rooms.find(r => r.id === roomId);\n\n  const filteredItems = selectedRoomFilter === 'all' \n    ? quote.items \n    : quote.items.filter(item => item.roomId === selectedRoomFilter);\n\n  const updateQuantity = (itemId: string, newQuantity: number) => {\n    const updatedItems = quote.items.map(item => {\n      if (item.id === itemId) {\n        const updatedItem = { ...item, quantity: newQuantity };\n        updatedItem.totalPrice = (updatedItem.basePrice * newQuantity) + \n          updatedItem.appliedProcessings.reduce((sum, ap) => sum + ap.calculatedPrice, 0);\n        return updatedItem;\n      }\n      return item;\n    });\n\n    recalculateQuote({ ...quote, items: updatedItems });\n  };\n\n  const removeItem = (itemId: string) => {\n    const updatedItems = quote.items.filter(item => item.id !== itemId);\n    recalculateQuote({ ...quote, items: updatedItems });\n  };\n\n  const getAvailableProcessings = (productId: string, currentProcessings: string[]) => {\n    const product = getProduct(productId);\n    if (!product) return [];\n\n    // Get processings applicable to this product category\n    let available = processings.filter(proc => \n      proc.applicableProductCategories.includes(product.category)\n    );\n\n    // Apply mutual exclusion rules\n    const mutualExclusionRules = processingRules.filter(rule => \n      rule.type === 'mutual_exclusion'\n    );\n\n    mutualExclusionRules.forEach(rule => {\n      const hasConflicting = currentProcessings.some(procId => \n        rule.conditions.processingIds?.includes(procId)\n      );\n      \n      if (hasConflicting && rule.actions.excludeProcessings) {\n        available = available.filter(proc => \n          !rule.actions.excludeProcessings?.includes(proc.id)\n        );\n      }\n    });\n\n    // Remove already applied processings\n    available = available.filter(proc => !currentProcessings.includes(proc.id));\n\n    return available;\n  };\n\n  const addProcessingToItem = (itemId: string, processingId: string, optionValues?: ProcessingOptionValue[]) => {\n    console.log('ðŸ”§ addProcessingToItem called:', { itemId, processingId, optionValues });\n    \n    const item = quote.items.find(i => i.id === itemId);\n    const processing = getProcessing(processingId);\n    const product = item ? getProduct(item.productId) : null;\n    \n    console.log('ðŸ”§ Found:', { item: !!item, processing: !!processing, product: !!product });\n    console.log('ðŸ”§ Processing details:', processing ? { \n      id: processing.id, \n      name: processing.name, \n      requiresOptions: processing.requiresOptions,\n      hasOptions: !!processing.options,\n      optionsCount: processing.options?.length || 0\n    } : 'null');\n\n    if (!item || !processing || !product) {\n      console.log('âŒ Missing required data, returning early');\n      return;\n    }\n\n    // If processing requires options but no option values provided, open option selector\n    if (processing.requiresOptions && (!optionValues || optionValues.length === 0)) {\n      console.log('ðŸ”§ Processing requires options, opening option selector...');\n      openOptionSelector(itemId, processingId);\n      return;\n    }\n\n    // Calculate processing price including option modifiers\n    let calculatedPrice = 0;\n    let optionPriceModifier = 0;\n    \n    if (optionValues) {\n      optionPriceModifier = optionValues.reduce((sum, ov) => sum + (ov.priceModifier || 0), 0);\n    }\n    \n    if (processing.pricingType === 'per_unit') {\n      calculatedPrice = (processing.price + optionPriceModifier) * item.quantity;\n    } else if (processing.pricingType === 'percentage') {\n      calculatedPrice = item.basePrice * item.quantity * processing.price;\n      if (optionPriceModifier > 0) {\n        calculatedPrice += optionPriceModifier * item.quantity;\n      }\n    } else if (processing.pricingType === 'per_dimension' && product.dimensions) {\n      calculatedPrice = (product.dimensions.width || 0) * processing.price;\n      if (optionPriceModifier > 0) {\n        calculatedPrice += optionPriceModifier;\n      }\n    }\n\n    const updatedItems = quote.items.map(i => {\n      if (i.id === itemId) {\n        const updatedItem = {\n          ...i,\n          appliedProcessings: [\n            ...i.appliedProcessings,\n            { \n              processingId, \n              calculatedPrice,\n              optionValues: optionValues || [],\n              requiresOptions: false // Options are now provided\n            }\n          ]\n        };\n        updatedItem.totalPrice = (updatedItem.basePrice * updatedItem.quantity) + \n          updatedItem.appliedProcessings.reduce((sum, ap) => sum + ap.calculatedPrice, 0);\n        return updatedItem;\n      }\n      return i;\n    });\n\n    recalculateQuote({ ...quote, items: updatedItems });\n  };\n\n  const removeProcessingFromItem = (itemId: string, processingId: string) => {\n    const updatedItems = quote.items.map(item => {\n      if (item.id === itemId) {\n        const updatedItem = {\n          ...item,\n          appliedProcessings: item.appliedProcessings.filter(ap => ap.processingId !== processingId)\n        };\n        updatedItem.totalPrice = (updatedItem.basePrice * updatedItem.quantity) + \n          updatedItem.appliedProcessings.reduce((sum, ap) => sum + ap.calculatedPrice, 0);\n        return updatedItem;\n      }\n      return item;\n    });\n\n    recalculateQuote({ ...quote, items: updatedItems });\n  };\n\n  const updateProcessingOptions = (itemId: string, processingId: string, optionValues: ProcessingOptionValue[]) => {\n    const item = quote.items.find(i => i.id === itemId);\n    const processing = getProcessing(processingId);\n    const product = item ? getProduct(item.productId) : null;\n    \n    if (!item || !processing || !product) return;\n\n    // Recalculate price with new option values\n    let calculatedPrice = 0;\n    let optionPriceModifier = optionValues.reduce((sum, ov) => sum + (ov.priceModifier || 0), 0);\n    \n    if (processing.pricingType === 'per_unit') {\n      calculatedPrice = (processing.price + optionPriceModifier) * item.quantity;\n    } else if (processing.pricingType === 'percentage') {\n      calculatedPrice = item.basePrice * item.quantity * processing.price;\n      if (optionPriceModifier > 0) {\n        calculatedPrice += optionPriceModifier * item.quantity;\n      }\n    } else if (processing.pricingType === 'per_dimension' && product.dimensions) {\n      calculatedPrice = (product.dimensions.width || 0) * processing.price;\n      if (optionPriceModifier > 0) {\n        calculatedPrice += optionPriceModifier;\n      }\n    }\n\n    const updatedItems = quote.items.map(i => {\n      if (i.id === itemId) {\n        const updatedItem = {\n          ...i,\n          appliedProcessings: i.appliedProcessings.map(ap => \n            ap.processingId === processingId \n              ? { \n                  ...ap, \n                  optionValues, \n                  calculatedPrice,\n                  requiresOptions: false // Options are now provided\n                }\n              : ap\n          )\n        };\n        updatedItem.totalPrice = (updatedItem.basePrice * updatedItem.quantity) + \n          updatedItem.appliedProcessings.reduce((sum, ap) => sum + ap.calculatedPrice, 0);\n        return updatedItem;\n      }\n      return i;\n    });\n\n    recalculateQuote({ ...quote, items: updatedItems });\n  };\n\n  // Check if there are any pending processing options that need resolution\n  const getPendingProcessingOptions = () => {\n    const pendingOptions: { itemId: string; processingId: string; processingName: string; requiredOptions: string[] }[] = [];\n    \n    quote.items.forEach(item => {\n      item.appliedProcessings.forEach(ap => {\n        if (ap.requiresOptions) {\n          const processing = getProcessing(ap.processingId);\n          if (processing && processing.options) {\n            const requiredOptions = processing.options\n              .filter(opt => opt.required)\n              .map(opt => opt.id);\n            \n            if (requiredOptions.length > 0) {\n              pendingOptions.push({\n                itemId: item.id,\n                processingId: ap.processingId,\n                processingName: processing.name,\n                requiredOptions\n              });\n            }\n          }\n        }\n      });\n    });\n    \n    return pendingOptions;\n  };\n\n  const openOptionSelector = (itemId: string, processingId: string) => {\n    console.log('ðŸ”§ openOptionSelector called:', { itemId, processingId });\n    \n    const processing = getProcessing(processingId);\n    console.log('ðŸ”§ Processing found:', processing ? {\n      id: processing.id,\n      name: processing.name,\n      requiresOptions: processing.requiresOptions,\n      hasOptions: !!processing.options\n    } : 'null');\n    \n    if (!processing || !processing.requiresOptions) {\n      console.log('âŒ Processing not found or does not require options, returning early');\n      return;\n    }\n\n    console.log('ðŸ”§ Opening option selector modal...');\n    setOptionSelector({\n      isOpen: true,\n      itemId,\n      processingId,\n      processing,\n      currentValues: []\n    });\n    console.log('âœ… Option selector state updated');\n  };\n\n  const closeOptionSelector = () => {\n    setOptionSelector({\n      isOpen: false,\n      itemId: '',\n      processingId: '',\n      processing: null,\n      currentValues: []\n    });\n  };\n\n  const handleOptionValuesChange = (values: ProcessingOptionValue[]) => {\n    setOptionSelector(prev => ({ ...prev, currentValues: values }));\n  };\n\n  const handleApplyOptions = () => {\n    if (optionSelector.processing && optionSelector.currentValues.length > 0) {\n      addProcessingToItem(optionSelector.itemId, optionSelector.processingId, optionSelector.currentValues);\n    } else if (optionSelector.processing) {\n      // If no options but processing requires them, add with empty values to flag as requiring options\n      addProcessingToItem(optionSelector.itemId, optionSelector.processingId, []);\n    }\n    closeOptionSelector();\n  };\n\n  const applyOrderDiscount = () => {\n    const updatedQuote = { ...quote, orderDiscount };\n    recalculateQuote(updatedQuote);\n  };\n\n  const recalculateQuote = (updatedQuote: Quote) => {\n    const subtotal = updatedQuote.items.reduce((sum, item) => sum + item.totalPrice, 0);\n    const customerDiscount = subtotal * (updatedQuote.customerDiscount / 100);\n    const totalDiscount = customerDiscount + updatedQuote.orderDiscount;\n    const finalTotal = subtotal - totalDiscount;\n\n    const finalQuote = {\n      ...updatedQuote,\n      subtotal,\n      totalDiscount,\n      finalTotal,\n      requiresApproval: finalTotal > updatedQuote.approvalThreshold\n    };\n\n    onQuoteUpdate(finalQuote);\n  };\n\n  // Group items by room for better organization\n  const itemsByRoom = quote.items.reduce((acc, item) => {\n    const roomId = item.roomId;\n    if (!acc[roomId]) acc[roomId] = [];\n    acc[roomId].push(item);\n    return acc;\n  }, {} as Record<string, typeof quote.items>);\n\n  const pendingOptions = getPendingProcessingOptions();\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Pending Processing Options Alert */}\n      {pendingOptions.length > 0 && (\n        <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-4\" data-testid=\"pending-options-alert\">\n          <div className=\"flex items-start\">\n            <div className=\"flex-shrink-0\">\n              <svg className=\"h-5 w-5 text-yellow-400\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                <path fillRule=\"evenodd\" d=\"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z\" clipRule=\"evenodd\" />\n              </svg>\n            </div>\n            <div className=\"ml-3\">\n              <h3 className=\"text-sm font-medium text-yellow-800\">\n                Processing Options Required\n              </h3>\n              <div className=\"mt-2 text-sm text-yellow-700\">\n                <p>The following processings require additional options to be specified:</p>\n                <ul className=\"mt-2 list-disc list-inside space-y-1\">\n                  {pendingOptions.map((option, index) => (\n                    <li key={index}>\n                      <strong>{option.processingName}</strong> - Missing: {option.requiredOptions.join(', ')}\n                    </li>\n                  ))}\n                </ul>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Room Filter */}\n      <div className=\"bg-white rounded-lg shadow p-4\">\n        <div className=\"flex items-center justify-between\">\n          <h3 className=\"text-lg font-medium text-gray-900\">Filter by Room</h3>\n          <select\n            value={selectedRoomFilter}\n            onChange={(e) => setSelectedRoomFilter(e.target.value)}\n            className=\"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n          >\n            <option value=\"all\">All Rooms ({quote.items.length} items)</option>\n            {rooms.map(room => {\n              const roomItems = quote.items.filter(item => item.roomId === room.id);\n              return (\n                <option key={room.id} value={room.id}>\n                  {room.name} ({roomItems.length} items)\n                </option>\n              );\n            })}\n          </select>\n        </div>\n      </div>\n\n      {/* Quote Items by Room */}\n      <div className=\"space-y-6\">\n        {selectedRoomFilter === 'all' ? (\n          // Show all rooms\n          rooms.map(room => {\n            const roomItems = itemsByRoom[room.id] || [];\n            if (roomItems.length === 0) return null;\n\n            return (\n              <div key={room.id} className=\"bg-white rounded-lg shadow\">\n                <div className=\"p-4 border-b border-gray-200 bg-blue-50\">\n                  <h3 className=\"text-lg font-medium text-gray-900\">{room.name}</h3>\n                  <p className=\"text-sm text-gray-600\">{roomItems.length} items</p>\n                </div>\n                <div className=\"divide-y divide-gray-200\">\n                  {roomItems.map(item => (\n                    <ItemRow\n                      key={item.id}\n                      item={item}\n                      product={getProduct(item.productId)}\n                      getProcessing={getProcessing}\n                      getAvailableProcessings={getAvailableProcessings}\n                      updateQuantity={updateQuantity}\n                      removeItem={removeItem}\n                      addProcessingToItem={addProcessingToItem}\n                      removeProcessingFromItem={removeProcessingFromItem}\n                      updateProcessingOptions={updateProcessingOptions}\n                      openOptionSelector={openOptionSelector}\n                    />\n                  ))}\n                </div>\n              </div>\n            );\n          })\n        ) : (\n          // Show single room\n          <div className=\"bg-white rounded-lg shadow\">\n            <div className=\"p-4 border-b border-gray-200\">\n              <h3 className=\"text-lg font-medium text-gray-900\">\n                {getRoom(selectedRoomFilter)?.name || 'Room'} Items\n              </h3>\n            </div>\n            <div className=\"divide-y divide-gray-200\">\n              {filteredItems.map(item => (\n                <ItemRow\n                  key={item.id}\n                  item={item}\n                  product={getProduct(item.productId)}\n                  getProcessing={getProcessing}\n                  getAvailableProcessings={getAvailableProcessings}\n                  updateQuantity={updateQuantity}\n                  removeItem={removeItem}\n                  addProcessingToItem={addProcessingToItem}\n                  removeProcessingFromItem={removeProcessingFromItem}\n                  updateProcessingOptions={updateProcessingOptions}\n                  openOptionSelector={openOptionSelector}\n                />\n              ))}\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Quote Totals */}\n      <div className=\"bg-white rounded-lg shadow p-6\">\n        <h3 className=\"text-lg font-medium text-gray-900 mb-4\">Quote Summary</h3>\n        \n        <div className=\"space-y-3\">\n          <div className=\"flex justify-between\">\n            <span className=\"text-gray-600\">Subtotal:</span>\n            <span className=\"font-medium\">${quote.subtotal.toFixed(2)}</span>\n          </div>\n          \n          {quote.customerDiscount > 0 && (\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600\">Customer Discount ({quote.customerDiscount}%):</span>\n              <span className=\"text-red-600\">-${(quote.subtotal * quote.customerDiscount / 100).toFixed(2)}</span>\n            </div>\n          )}\n          \n          <div className=\"flex justify-between items-center\">\n            <span className=\"text-gray-600\">Order Discount:</span>\n            <div className=\"flex items-center space-x-2\">\n              <input\n                type=\"number\"\n                min=\"0\"\n                step=\"0.01\"\n                value={orderDiscount}\n                onChange={(e) => setOrderDiscount(parseFloat(e.target.value) || 0)}\n                className=\"w-24 px-2 py-1 border border-gray-300 rounded text-right\"\n                placeholder=\"0.00\"\n              />\n              <button\n                onClick={applyOrderDiscount}\n                className=\"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700\"\n              >\n                Apply\n              </button>\n            </div>\n          </div>\n\n          <div className=\"pt-3 border-t border-gray-200\">\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-lg font-semibold text-gray-900\">Final Total:</span>\n              <span className=\"text-xl font-bold text-green-600\">${quote.finalTotal.toFixed(2)}</span>\n            </div>\n          </div>\n\n          {quote.requiresApproval && (\n            <div className=\"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded\">\n              <p className=\"text-sm text-yellow-800\">\n                âš ï¸ This quote requires approval as it exceeds ${quote.approvalThreshold.toLocaleString()}\n              </p>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Processing Option Selector Modal */}\n      {optionSelector.isOpen && optionSelector.processing && (\n        <ProcessingOptionSelector\n          processing={optionSelector.processing}\n          currentValues={optionSelector.currentValues}\n          onValuesChange={handleOptionValuesChange}\n          onApply={handleApplyOptions}\n          onCancel={closeOptionSelector}\n        />\n      )}\n    </div>\n  );\n};\n\n// Extracted ItemRow component for cleaner code\nconst ItemRow: React.FC<{\n  item: any;\n  product: any;\n  getProcessing: any;\n  getAvailableProcessings: any;\n  updateQuantity: any;\n  removeItem: any;\n  addProcessingToItem: any;\n  removeProcessingFromItem: any;\n  updateProcessingOptions: any;\n  openOptionSelector: any;\n}> = ({\n  item,\n  product,\n  getProcessing,\n  getAvailableProcessings,\n  updateQuantity,\n  removeItem,\n  addProcessingToItem,\n  removeProcessingFromItem,\n  updateProcessingOptions,\n  openOptionSelector\n}) => {\n  if (!product) return null;\n\n  const currentProcessingIds = item.appliedProcessings.map((ap: any) => ap.processingId);\n  const availableProcessings = getAvailableProcessings(item.productId, currentProcessingIds);\n\n  return (\n    <div className=\"p-6\">\n      <div className=\"flex justify-between items-start mb-4\">\n        <div className=\"flex-1\">\n          <h4 className=\"text-lg font-medium text-gray-900\">{product.name}</h4>\n          <p className=\"text-sm text-gray-600\">{product.description}</p>\n          {product.dimensions && (\n            <p className=\"text-xs text-gray-500 mt-1\">\n              {product.dimensions.width}\"W Ã— {product.dimensions.height}\"H Ã— {product.dimensions.depth}\"D\n            </p>\n          )}\n        </div>\n        \n        <div className=\"flex items-center space-x-4\">\n          <div className=\"flex items-center space-x-2\">\n            <label className=\"text-sm text-gray-600\">Qty:</label>\n            <input\n              type=\"number\"\n              min=\"1\"\n              value={item.quantity}\n              onChange={(e) => updateQuantity(item.id, parseInt(e.target.value) || 1)}\n              className=\"w-16 px-2 py-1 border border-gray-300 rounded text-center\"\n            />\n          </div>\n          \n          <div className=\"text-right\">\n            <p className=\"text-lg font-semibold text-gray-900\">\n              ${item.totalPrice.toFixed(2)}\n            </p>\n            <p className=\"text-xs text-gray-500\">\n              Base: ${(item.basePrice * item.quantity).toFixed(2)}\n            </p>\n          </div>\n          \n          <button\n            onClick={() => removeItem(item.id)}\n            className=\"text-red-600 hover:text-red-800 p-1\"\n            title=\"Remove item\"\n          >\n            âœ•\n          </button>\n        </div>\n      </div>\n\n      {/* Applied Processings */}\n      {item.appliedProcessings.length > 0 && (\n        <div className=\"mb-4\">\n          <h5 className=\"text-sm font-medium text-gray-700 mb-2\">Applied Processings:</h5>\n          <div className=\"space-y-2\">\n            {item.appliedProcessings.map((ap: any) => {\n              const processing = getProcessing(ap.processingId);\n              return (\n                <div key={ap.processingId} className={`px-3 py-2 rounded ${ap.requiresOptions ? 'bg-yellow-50 border border-yellow-200' : 'bg-blue-50'}`} data-testid=\"applied-processing\">\n                  <div className=\"flex justify-between items-start\">\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center space-x-2\">\n                        <span className=\"text-sm font-medium text-blue-900\">{processing?.name}</span>\n                        {ap.requiresOptions && (\n                          <span className=\"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-yellow-100 text-yellow-800\">\n                            Options Required\n                          </span>\n                        )}\n                      </div>\n                      <span className=\"text-xs text-blue-700\">{processing?.description}</span>\n                      \n                      {/* Show option values if they exist */}\n                      {ap.optionValues && ap.optionValues.length > 0 && (\n                        <div className=\"mt-2 text-xs text-gray-600\">\n                          <strong>Options:</strong>\n                          <ul className=\"ml-2 mt-1 space-y-1\">\n                            {ap.optionValues.map((ov: any, index: number) => {\n                              const option = processing?.options?.find((opt: ProcessingOption) => opt.id === ov.optionId);\n                              return (\n                                <li key={index}>\n                                  {option?.name}: {ov.value}\n                                  {ov.priceModifier && ov.priceModifier > 0 && (\n                                    <span className=\"text-green-600 ml-1\">(+${ov.priceModifier})</span>\n                                  )}\n                                </li>\n                              );\n                            })}\n                          </ul>\n                        </div>\n                      )}\n                    </div>\n                    \n                    <div className=\"flex items-center space-x-2\">\n                      <span className=\"text-sm font-medium text-blue-900\">\n                        +${ap.calculatedPrice.toFixed(2)}\n                      </span>\n                      <button\n                        onClick={() => removeProcessingFromItem(item.id, ap.processingId)}\n                        className=\"text-red-600 hover:text-red-800 text-xs\"\n                      >\n                        Remove\n                      </button>\n                    </div>\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n        </div>\n      )}\n\n      {/* Available Processings */}\n      {availableProcessings.length > 0 && (\n        <div>\n          <h5 className=\"text-sm font-medium text-gray-700 mb-2\">Available Processings:</h5>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3\" data-testid=\"available-processings\">\n            {availableProcessings.map((processing: any) => (\n              <button\n                key={processing.id}\n                data-testid=\"processing-item\"\n                onClick={() => addProcessingToItem(item.id, processing.id)}\n                className=\"text-left p-3 border border-gray-200 rounded hover:border-blue-300 hover:bg-blue-50 transition-colors\"\n              >\n                <div className=\"flex justify-between items-start\">\n                  <div>\n                    <h6 className=\"text-sm font-medium text-gray-900\">{processing.name}</h6>\n                    <p className=\"text-xs text-gray-600\">{processing.description}</p>\n                    {processing.requiresOptions && (\n                      <span className=\"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-orange-100 text-orange-800 mt-1\">\n                        Requires Options\n                      </span>\n                    )}\n                  </div>\n                  <div className=\"text-right\">\n                    <p className=\"text-sm font-medium text-green-600\">\n                      {processing.pricingType === 'percentage' \n                        ? `${(processing.price * 100).toFixed(0)}%`\n                        : `$${processing.price.toFixed(2)}`\n                      }\n                    </p>\n                    <p className=\"text-xs text-gray-500\">{processing.pricingType.replace('_', ' ')}</p>\n                  </div>\n                </div>\n              </button>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\n// ProcessingOptionSelector component for handling processing options\nconst ProcessingOptionSelector: React.FC<{\n  processing: Processing;\n  currentValues: ProcessingOptionValue[];\n  onValuesChange: (values: ProcessingOptionValue[]) => void;\n  onApply: () => void;\n  onCancel: () => void;\n}> = ({ processing, currentValues, onValuesChange, onApply, onCancel }) => {\n  const [values, setValues] = useState<ProcessingOptionValue[]>(currentValues);\n\n  const handleOptionChange = (optionId: string, value: any, priceModifier?: number) => {\n    const newValues = values.filter(v => v.optionId !== optionId);\n    if (value !== undefined && value !== '') {\n      newValues.push({ optionId, value, priceModifier });\n    }\n    setValues(newValues);\n    onValuesChange(newValues);\n  };\n\n  const getCurrentValue = (optionId: string) => {\n    const value = values.find(v => v.optionId === optionId)?.value;\n    if (value === undefined || value === null) return '';\n    return String(value);\n  };\n\n  const renderOptionInput = (option: ProcessingOption) => {\n    const currentValue = getCurrentValue(option.id);\n\n    switch (option.type) {\n      case 'text':\n        return (\n          <input\n            type=\"text\"\n            value={currentValue}\n            onChange={(e) => handleOptionChange(option.id, e.target.value)}\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            placeholder={option.name}\n          />\n        );\n      \n      case 'number':\n        return (\n          <input\n            type=\"number\"\n            value={currentValue}\n            onChange={(e) => handleOptionChange(option.id, parseFloat(e.target.value) || 0)}\n            min={option.validation?.min}\n            max={option.validation?.max}\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            placeholder={option.name}\n          />\n        );\n      \n      case 'select':\n        return (\n          <select\n            value={currentValue}\n            onChange={(e) => {\n              const choice = option.choices?.find(c => c.value === e.target.value);\n              handleOptionChange(option.id, e.target.value, choice?.priceModifier);\n            }}\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n          >\n            <option value=\"\">Select {option.name}</option>\n            {option.choices?.map((choice, index) => (\n              <option key={index} value={choice.value}>\n                {choice.label} {choice.priceModifier && choice.priceModifier > 0 ? `(+$${choice.priceModifier})` : ''}\n              </option>\n            ))}\n          </select>\n        );\n      \n      case 'boolean':\n        const booleanValue = values.find(v => v.optionId === option.id)?.value === true;\n        return (\n          <div className=\"flex items-center\">\n            <input\n              type=\"checkbox\"\n              checked={booleanValue}\n              onChange={(e) => handleOptionChange(option.id, e.target.checked)}\n              className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n            />\n            <label className=\"ml-2 text-sm text-gray-700\">{option.name}</label>\n          </div>\n        );\n      \n      default:\n        return null;\n    }\n  };\n\n  const isFormValid = () => {\n    if (!processing.options) return true;\n    return processing.options.every(option => \n      !option.required || getCurrentValue(option.id) !== ''\n    );\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\" data-testid=\"option-selector-modal\">\n      <div className=\"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 max-h-96 overflow-y-auto\">\n        <div className=\"p-6\">\n          <h3 className=\"text-lg font-medium text-gray-900 mb-4\">\n            Configure {processing.name}\n          </h3>\n          \n          <div className=\"space-y-4\">\n            {processing.options?.map((option) => (\n              <div key={option.id}>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  {option.name}\n                  {option.required && <span className=\"text-red-500 ml-1\">*</span>}\n                </label>\n                <div data-testid=\"option-input\">\n                  {renderOptionInput(option)}\n                </div>\n                {option.validation && (\n                  <p className=\"text-xs text-gray-500 mt-1\">\n                    {option.validation.min !== undefined && `Min: ${option.validation.min}`}\n                    {option.validation.max !== undefined && ` Max: ${option.validation.max}`}\n                  </p>\n                )}\n              </div>\n            ))}\n          </div>\n          \n          <div className=\"flex justify-end space-x-3 mt-6\">\n            <button\n              onClick={onCancel}\n              data-testid=\"cancel-options-button\"\n              className=\"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500\"\n            >\n              Cancel\n            </button>\n            <button\n              onClick={onApply}\n              data-testid=\"apply-options-button\"\n              disabled={!isFormValid()}\n              className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              Apply\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default SimplifiedQuoteBuilder;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}